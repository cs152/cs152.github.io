<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Lecture 1: Background and Prerequisites – CS 152: Neural Networks</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">CS 152: Neural Networks</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../calendar/calendar.html"> 
<span class="menu-text">Calendar</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://drive.google.com/drive/folders/1JFhwmcFBTHiRbfhQ0VRDj9xIPxFpHuWj?usp=drive_link"> 
<span class="menu-text">Homeworks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../assignments/final-project/outline.html"> 
<span class="menu-text">Project</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/orgs/CS152/"> 
<span class="menu-text">Github</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.gradescope.com/courses/710173"> 
<span class="menu-text">Gradescope</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#linear-algebra-prerequisites" id="toc-linear-algebra-prerequisites" class="nav-link active" data-scroll-target="#linear-algebra-prerequisites">Linear algebra prerequisites</a>
  <ul class="collapse">
  <li><a href="#numpy" id="toc-numpy" class="nav-link" data-scroll-target="#numpy">Numpy</a></li>
  <li><a href="#scalars" id="toc-scalars" class="nav-link" data-scroll-target="#scalars">Scalars</a></li>
  <li><a href="#vectors" id="toc-vectors" class="nav-link" data-scroll-target="#vectors">Vectors</a></li>
  <li><a href="#entries" id="toc-entries" class="nav-link" data-scroll-target="#entries">Entries</a></li>
  <li><a href="#vector-interpretation" id="toc-vector-interpretation" class="nav-link" data-scroll-target="#vector-interpretation">Vector interpretation</a></li>
  <li><a href="#vectors-as-data" id="toc-vectors-as-data" class="nav-link" data-scroll-target="#vectors-as-data">Vectors as data</a></li>
  <li><a href="#vector-equality" id="toc-vector-equality" class="nav-link" data-scroll-target="#vector-equality">Vector equality</a></li>
  <li><a href="#vector-equality-in-numpy" id="toc-vector-equality-in-numpy" class="nav-link" data-scroll-target="#vector-equality-in-numpy">Vector equality in Numpy</a></li>
  <li><a href="#vector-addition" id="toc-vector-addition" class="nav-link" data-scroll-target="#vector-addition">Vector addition</a></li>
  <li><a href="#vector-addition-1" id="toc-vector-addition-1" class="nav-link" data-scroll-target="#vector-addition-1">Vector addition</a></li>
  <li><a href="#element-wise-operations" id="toc-element-wise-operations" class="nav-link" data-scroll-target="#element-wise-operations">Element-wise operations</a></li>
  <li><a href="#note-on-logarithms" id="toc-note-on-logarithms" class="nav-link" data-scroll-target="#note-on-logarithms">Note on logarithms</a></li>
  <li><a href="#scalar-vector-operations" id="toc-scalar-vector-operations" class="nav-link" data-scroll-target="#scalar-vector-operations">Scalar-vector operations</a></li>
  <li><a href="#vector-magnitude" id="toc-vector-magnitude" class="nav-link" data-scroll-target="#vector-magnitude">Vector magnitude</a></li>
  <li><a href="#vector-magnitude-1" id="toc-vector-magnitude-1" class="nav-link" data-scroll-target="#vector-magnitude-1">Vector magnitude</a></li>
  <li><a href="#unit-vectors" id="toc-unit-vectors" class="nav-link" data-scroll-target="#unit-vectors">Unit vectors</a></li>
  <li><a href="#dot-products" id="toc-dot-products" class="nav-link" data-scroll-target="#dot-products">Dot products</a></li>
  <li><a href="#dot-products-1" id="toc-dot-products-1" class="nav-link" data-scroll-target="#dot-products-1">Dot products</a></li>
  <li><a href="#dot-products-2" id="toc-dot-products-2" class="nav-link" data-scroll-target="#dot-products-2">Dot products</a></li>
  <li><a href="#matrices" id="toc-matrices" class="nav-link" data-scroll-target="#matrices">Matrices</a></li>
  <li><a href="#matrix-elements" id="toc-matrix-elements" class="nav-link" data-scroll-target="#matrix-elements">Matrix elements</a></li>
  <li><a href="#matrix-creation-in-numpy" id="toc-matrix-creation-in-numpy" class="nav-link" data-scroll-target="#matrix-creation-in-numpy">Matrix creation in Numpy</a></li>
  <li><a href="#slicing-matrices" id="toc-slicing-matrices" class="nav-link" data-scroll-target="#slicing-matrices">Slicing matrices</a></li>
  <li><a href="#slicing-matrices-1" id="toc-slicing-matrices-1" class="nav-link" data-scroll-target="#slicing-matrices-1">Slicing matrices</a></li>
  <li><a href="#slicing-matrices-2" id="toc-slicing-matrices-2" class="nav-link" data-scroll-target="#slicing-matrices-2">Slicing matrices</a></li>
  <li><a href="#advanced-slicing-in-numpy" id="toc-advanced-slicing-in-numpy" class="nav-link" data-scroll-target="#advanced-slicing-in-numpy">Advanced slicing in numpy</a></li>
  <li><a href="#advanced-slicing-in-numpy-1" id="toc-advanced-slicing-in-numpy-1" class="nav-link" data-scroll-target="#advanced-slicing-in-numpy-1">Advanced slicing in numpy</a></li>
  <li><a href="#matrix-shapes" id="toc-matrix-shapes" class="nav-link" data-scroll-target="#matrix-shapes">Matrix shapes</a></li>
  <li><a href="#matrix-transpose" id="toc-matrix-transpose" class="nav-link" data-scroll-target="#matrix-transpose">Matrix transpose</a></li>
  <li><a href="#element-wise-matrix-operations" id="toc-element-wise-matrix-operations" class="nav-link" data-scroll-target="#element-wise-matrix-operations">Element-wise matrix operations</a></li>
  <li><a href="#matrix-vector-products" id="toc-matrix-vector-products" class="nav-link" data-scroll-target="#matrix-vector-products">Matrix-vector products</a></li>
  <li><a href="#matrix-vector-products-1" id="toc-matrix-vector-products-1" class="nav-link" data-scroll-target="#matrix-vector-products-1">Matrix-vector products</a></li>
  <li><a href="#matrix-multiplication" id="toc-matrix-multiplication" class="nav-link" data-scroll-target="#matrix-multiplication">Matrix multiplication</a></li>
  <li><a href="#matrix-multiplication-1" id="toc-matrix-multiplication-1" class="nav-link" data-scroll-target="#matrix-multiplication-1">Matrix multiplication</a></li>
  <li><a href="#matrix-multiplication-2" id="toc-matrix-multiplication-2" class="nav-link" data-scroll-target="#matrix-multiplication-2">Matrix multiplication</a></li>
  <li><a href="#element-wise-multiplication" id="toc-element-wise-multiplication" class="nav-link" data-scroll-target="#element-wise-multiplication">Element-wise multiplication</a></li>
  <li><a href="#matrix-reductions" id="toc-matrix-reductions" class="nav-link" data-scroll-target="#matrix-reductions">Matrix reductions</a></li>
  <li><a href="#matrix-reductions-1" id="toc-matrix-reductions-1" class="nav-link" data-scroll-target="#matrix-reductions-1">Matrix reductions</a></li>
  <li><a href="#other-matrix-reduction-examples" id="toc-other-matrix-reduction-examples" class="nav-link" data-scroll-target="#other-matrix-reduction-examples">Other matrix reduction examples</a></li>
  <li><a href="#identity-matrices" id="toc-identity-matrices" class="nav-link" data-scroll-target="#identity-matrices">Identity Matrices</a></li>
  <li><a href="#solving-systems-of-linear-equations" id="toc-solving-systems-of-linear-equations" class="nav-link" data-scroll-target="#solving-systems-of-linear-equations">Solving systems of linear equations</a></li>
  <li><a href="#inverse-matrices" id="toc-inverse-matrices" class="nav-link" data-scroll-target="#inverse-matrices">Inverse matrices</a></li>
  </ul></li>
  <li><a href="#calculus-prerequisites" id="toc-calculus-prerequisites" class="nav-link" data-scroll-target="#calculus-prerequisites">Calculus prerequisites</a>
  <ul class="collapse">
  <li><a href="#functions" id="toc-functions" class="nav-link" data-scroll-target="#functions">Functions</a></li>
  <li><a href="#derivatives" id="toc-derivatives" class="nav-link" data-scroll-target="#derivatives">Derivatives</a></li>
  <li><a href="#derivative-operator" id="toc-derivative-operator" class="nav-link" data-scroll-target="#derivative-operator">Derivative operator</a></li>
  <li><a href="#derivative-functions" id="toc-derivative-functions" class="nav-link" data-scroll-target="#derivative-functions">Derivative functions</a></li>
  <li><a href="#basic-derivative-rules" id="toc-basic-derivative-rules" class="nav-link" data-scroll-target="#basic-derivative-rules">Basic derivative rules</a></li>
  <li><a href="#compositions-of-functions" id="toc-compositions-of-functions" class="nav-link" data-scroll-target="#compositions-of-functions">Compositions of functions</a></li>
  <li><a href="#chain-rule" id="toc-chain-rule" class="nav-link" data-scroll-target="#chain-rule">Chain rule</a></li>
  <li><a href="#multivariate-functions" id="toc-multivariate-functions" class="nav-link" data-scroll-target="#multivariate-functions">Multivariate functions</a></li>
  <li><a href="#partial-derivatives" id="toc-partial-derivatives" class="nav-link" data-scroll-target="#partial-derivatives">Partial derivatives</a></li>
  <li><a href="#partial-derivative-functions" id="toc-partial-derivative-functions" class="nav-link" data-scroll-target="#partial-derivative-functions">Partial derivative functions</a></li>
  <li><a href="#functions-of-vectors" id="toc-functions-of-vectors" class="nav-link" data-scroll-target="#functions-of-vectors">Functions of vectors</a></li>
  <li><a href="#gradients" id="toc-gradients" class="nav-link" data-scroll-target="#gradients">Gradients</a></li>
  <li><a href="#gradient-functions" id="toc-gradient-functions" class="nav-link" data-scroll-target="#gradient-functions">Gradient functions</a></li>
  </ul></li>
  <li><a href="#visualization-with-numpy-and-matplotlib" id="toc-visualization-with-numpy-and-matplotlib" class="nav-link" data-scroll-target="#visualization-with-numpy-and-matplotlib">Visualization with NumPy and Matplotlib</a>
  <ul class="collapse">
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">Getting started</a></li>
  <li><a href="#scatterplots" id="toc-scatterplots" class="nav-link" data-scroll-target="#scatterplots">Scatterplots</a></li>
  <li><a href="#line-plots" id="toc-line-plots" class="nav-link" data-scroll-target="#line-plots">Line plots</a></li>
  <li><a href="#multiple-plots" id="toc-multiple-plots" class="nav-link" data-scroll-target="#multiple-plots">Multiple plots</a></li>
  <li><a href="#plot-ranges" id="toc-plot-ranges" class="nav-link" data-scroll-target="#plot-ranges">Plot ranges</a></li>
  <li><a href="#histograms" id="toc-histograms" class="nav-link" data-scroll-target="#histograms">Histograms</a></li>
  <li><a href="#subplots-and-plot-sizes" id="toc-subplots-and-plot-sizes" class="nav-link" data-scroll-target="#subplots-and-plot-sizes">Subplots and plot sizes</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="slides.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lecture 1: Background and Prerequisites</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="linear-algebra-prerequisites" class="level1">
<h1>Linear algebra prerequisites</h1>
<p>We will begin with a review of many of the basic concepts from linear algebra that we will need for this course. As we go through these concepts we will see how to implement them in Python.</p>
<section id="numpy" class="level2">
<h2 class="anchored" data-anchor-id="numpy">Numpy</h2>
<p><a href="https://numpy.org/"><strong>Numpy</strong></a> Is the linear algebra library that we will be using for much of this class. The standard way to import Numpy is:</p>
<div id="06fc3068" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The most basic object from Numpy that we will just is the <em>array</em> (<code>np.array</code>), which will represent vectors matrices and even higher-dimensional objects known as <em>tensors</em>.</p>
</section>
<section id="scalars" class="level2">
<h2 class="anchored" data-anchor-id="scalars">Scalars</h2>
<p><strong>Scalars</strong> are just single numbers. In our math we will typically denote scalars with a lower-case letter. For example, we might call a scalar <span class="math inline">\(x\)</span> and give it a value as <span class="math display">\[x=3.5\]</span> In code:</p>
<div id="82e875d5" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="fl">3.5</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># or as a 0-dimensional numpy array</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array(<span class="fl">3.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="vectors" class="level2">
<h2 class="anchored" data-anchor-id="vectors">Vectors</h2>
<p><strong>Vectors</strong> are ordered lists of numbers, as shown below. We will typically denote vectors with <strong>bold</strong> lower case letters, such as <span class="math inline">\(\mathbf{x}\)</span>.</p>
<p><span class="math display">\[
\mathbf{x} = \begin{bmatrix} 2\\ 5\\ 1\end{bmatrix}
\]</span></p>
<p>In Numpy, we can create an array object representing a vector by passing <code>np.array</code> a list of numbers.</p>
<div id="9dd91974" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array([<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="entries" class="level2">
<h2 class="anchored" data-anchor-id="entries">Entries</h2>
<p>The individual numbers in the vector are called the <em>entries</em> and we will refer to them individually as subscripted scalars: <span class="math inline">\(x_1, x_2,…,x_n\)</span>.</p>
<p><span class="math display">\[
\mathbf{x} = \begin{bmatrix} x_1\\ x_2\\ x_3\end{bmatrix}
\]</span></p>
<p>In numpy we can access individual elements of a vector using <code>[]</code> operators (note that numpy is 0-indexed!).</p>
<div id="52f8975a" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>np.int64(2)</code></pre>
</div>
</div>
</section>
<section id="vector-interpretation" class="level2">
<h2 class="anchored" data-anchor-id="vector-interpretation">Vector interpretation</h2>
<p>A vector represents either a <em>location</em> or a <em>change in location</em> in <span class="math inline">\(n\)</span> -dimensional space.</p>
<div id="bca40ea8" class="cell" data-execution_count="6">
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Manim Community <span style="color: #008000; text-decoration-color: #008000">v0.18.1</span>

</pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="slides_files/figure-html/cell-7-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="vectors-as-data" class="level2">
<h2 class="anchored" data-anchor-id="vectors-as-data">Vectors as data</h2>
<p>A space of vectors could represent students, with each entry corresponding to a student’s grade in a different subject:</p>
<p><span class="math display">\[
\text{Student } \mathbf{x} = \begin{bmatrix} \text{Math} \\ \text{CS} \\ \text{Literature} \\\text{History} \end{bmatrix}
\]</span></p>
<p>Any two students might have different grades across the subjects. We can represent these two students (say <span class="math inline">\(\mathbf{x}_1\)</span> and <span class="math inline">\(\mathbf{x}_2\)</span>) as two vectors.</p>
<p><span class="math display">\[
\mathbf{x}_1 = \begin{bmatrix} 3.0 \\ 4.0 \\ 3.7 \\ 2.3 \end{bmatrix}, \quad \mathbf{x}_2 = \begin{bmatrix} 3.7 \\ 3.3 \\ 3.3 \\ 4.0 \end{bmatrix}
\]</span></p>
</section>
<section id="vector-equality" class="level2">
<h2 class="anchored" data-anchor-id="vector-equality">Vector equality</h2>
<p>We say that two vectors are <em>equal</em> if and only if all of the corresponding elements are equal, so <span class="math display">\[\mathbf{x} = \mathbf{y}\]</span> implies that <span class="math display">\[x_1=y_1, x_2=y_2…\]</span></p>
</section>
<section id="vector-equality-in-numpy" class="level2">
<h2 class="anchored" data-anchor-id="vector-equality-in-numpy">Vector equality in Numpy</h2>
<div id="ff6f7df9" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array([<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">1</span>])</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array([<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">2</span>])</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">==</span> y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>array([False,  True, False])</code></pre>
</div>
</div>
<p>We can check if all entries are equal (and therefore the vectors are equal) using the <code>np.all</code> function.</p>
<div id="eb4cd56b" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">all</span>(x <span class="op">==</span> y), np.<span class="bu">all</span>(x <span class="op">==</span> x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>(np.False_, np.True_)</code></pre>
</div>
</div>
<p>Other comparison operators (<code>&gt;</code>,<code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>!=</code>) also perform element-wise comparison in numpy.</p>
</section>
<section id="vector-addition" class="level2">
<h2 class="anchored" data-anchor-id="vector-addition">Vector addition</h2>
<p>When we add or subtract vectors, we add or subtract the corresponding elements.</p>
<p><span class="math display">\[\mathbf{x} + \mathbf{y} = \begin{bmatrix} x_1\\ x_2\\ x_3\end{bmatrix} + \begin{bmatrix} y_1\\ y_2\\ y_3\end{bmatrix} = \begin{bmatrix} x_1 + y_1\\ x_2 + y_2\\ x_3 + y_3\end{bmatrix}\]</span> This works the same in numpy</p>
<div id="5929d7bb" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">+</span> y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>array([ 5, 10,  3])</code></pre>
</div>
</div>
</section>
<section id="vector-addition-1" class="level2">
<h2 class="anchored" data-anchor-id="vector-addition-1">Vector addition</h2>
<p>Addition corresponds to <em>shifting</em> the point <span class="math inline">\(\mathbf{x}\)</span> by the vector <span class="math inline">\(\mathbf{y}\)</span>.</p>
<div id="99dd313f" class="cell" data-execution_count="10">
<div class="cell-output cell-output-display">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">Manim Community <span style="color: #008000; text-decoration-color: #008000">v0.18.1</span>

</pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="slides_files/figure-html/cell-11-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="element-wise-operations" class="level2">
<h2 class="anchored" data-anchor-id="element-wise-operations">Element-wise operations</h2>
<p>In both mathematical notation and numpy, most operations on vectors will be assumed to be taken <em>element-wise</em>. That is,</p>
<p><span class="math display">\[
\mathbf{x}^2 = \begin{bmatrix} x_1^2 \\ x_2^2 \\ x_3^2 \end{bmatrix} , \quad \log(\mathbf{x}) = \begin{bmatrix} \log x_1 \\ \log x_2 \\ \log x_3 \end{bmatrix},\ \text{etc.}
\]</span></p>
<p>In numpy:</p>
<div id="0024050b" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">**</span> <span class="dv">2</span>, np.log(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>(array([ 4, 25,  1]), array([0.69314718, 1.60943791, 0.        ]))</code></pre>
</div>
</div>
</section>
<section id="note-on-logarithms" class="level2">
<h2 class="anchored" data-anchor-id="note-on-logarithms">Note on logarithms</h2>
<p>Note that in this class (and in numpy!) logarithms are assumed to be base <span class="math inline">\(e\)</span>, otherwise known as <em>natural logarithms</em>.</p>
</section>
<section id="scalar-vector-operations" class="level2">
<h2 class="anchored" data-anchor-id="scalar-vector-operations">Scalar-vector operations</h2>
<p>Operations between scalars and vectors are also assumed to be element-wise as in this scalar-vector multiplication</p>
<p><span class="math display">\[
a\mathbf{x} = \begin{bmatrix} a x_1 \\ a x_2 \\ a x_3 \end{bmatrix}, \quad a + \mathbf{x} = \begin{bmatrix} a + x_1 \\ a + x_2 \\ a + x_3 \end{bmatrix}
\]</span></p>
</section>
<section id="vector-magnitude" class="level2">
<h2 class="anchored" data-anchor-id="vector-magnitude">Vector magnitude</h2>
<p>The <em>magnitude</em> of a vector its length in <span class="math inline">\(\mathbb{R}^n\)</span>, or equivalently the Euclidean distance from the origin to the point the vector represents. It is denoted as<span class="math inline">\(\|\mathbf{x}\|_2\)</span> and defined as:</p>
<p><span class="math display">\[
\|\mathbf{x}\|_2 = \sqrt{\sum_{i=1}^n x_i^2}
\]</span></p>
<p>The subscript <span class="math inline">\(2\)</span> specifies that we are talking about Euclidean distance. Because of this we will also refer to the magnitude as the <em>two-norm</em>.</p>
<p>In numpy we can compute this using the <code>np.linalg.norm</code> function.</p>
<div id="52565acf" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>xnorm <span class="op">=</span> np.linalg.norm(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="vector-magnitude-1" class="level2">
<h2 class="anchored" data-anchor-id="vector-magnitude-1">Vector magnitude</h2>
<p>We can also compute magnitude explicitly with the <code>np.sum</code> function, which computes the sum of the elements of a vector.</p>
<div id="2b40ad76" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>xnorm_explicit <span class="op">=</span> np.sqrt(np.<span class="bu">sum</span>(x <span class="op">**</span> <span class="dv">2</span>))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>xnorm, xnorm_explicit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>(np.float64(5.477225575051661), np.float64(5.477225575051661))</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Other useful aggregation functions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="6d0aa687" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.mean(x))    <span class="co"># Take the mean of the elements in x</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.std(x))     <span class="co"># Take the standard deviation of the elements in x</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.<span class="bu">min</span>(x))     <span class="co"># Find the minimum element in x</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.<span class="bu">max</span>(x))     <span class="co"># Find the maximum element in x</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2.6666666666666665
1.699673171197595
1
5</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="unit-vectors" class="level2">
<h2 class="anchored" data-anchor-id="unit-vectors">Unit vectors</h2>
<p>A <strong>unit vector</strong> is a vector with length <span class="math inline">\(1\)</span>. We can find a unit vector that has the same <em>direction</em> as <span class="math inline">\(\mathbf{x}\)</span> by dividing <span class="math inline">\(\mathbf{x}\)</span> by it’s magnitude:</p>
<p><span class="math display">\[
\frac{\mathbf{x}}{\|\mathbf{x}\|_2}
\]</span></p>
<div id="95bab728" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">/</span> np.linalg.norm(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>array([0.36514837, 0.91287093, 0.18257419])</code></pre>
</div>
</div>
</section>
<section id="dot-products" class="level2">
<h2 class="anchored" data-anchor-id="dot-products">Dot products</h2>
<p>The <strong>dot-product</strong> operation between two vectors is defined as</p>
<p><span class="math display">\[
\mathbf{x} \cdot \mathbf{y} = \sum_{i=1}^n x_i y_i
\]</span></p>
<p>The result is a scalar whose value is equal to <span class="math inline">\(\|\mathbf{x}\|_2\|\mathbf{y}\|_2 \cos\theta\)</span>, where <span class="math inline">\(\theta\)</span> is the <em>angle</em> between them.</p>
<p>We can compute dot products in numpy using the <code>np.dot</code> function</p>
<div id="fb18662e" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>np.dot(x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>np.int64(33)</code></pre>
</div>
</div>
</section>
<section id="dot-products-1" class="level2">
<h2 class="anchored" data-anchor-id="dot-products-1">Dot products</h2>
<p>If <span class="math inline">\(\theta=\frac{\pi}{2}\)</span>, the vectors are <em>orthogonal</em> and the dot product with be <span class="math inline">\(0\)</span>. If <span class="math inline">\(\theta&gt;\frac{\pi}{2}\)</span> or <span class="math inline">\(\theta &lt; -\frac{\pi}{2}\)</span> , the dot product will be negative.</p>
<p>If <span class="math inline">\(\theta=0\)</span> then <span class="math inline">\(\cos(\theta)=1\)</span>. In this case we say the vectors are <em>colinear</em>. This formulation implies that given two vectors of fixed length, the dot product is maximized with they are colinear ( <span class="math inline">\(\theta=0\)</span> ).</p>
</section>
<section id="dot-products-2" class="level2">
<h2 class="anchored" data-anchor-id="dot-products-2">Dot products</h2>
<p>Geometrically, <span class="math inline">\(\|\mathbf{x}\|_2\cos\theta\)</span> is the length of the <em>projection</em> of <span class="math inline">\(\mathbf{x}\)</span> onto <span class="math inline">\(\mathbf{y}\)</span>. Thus, we can compute the length of this projection using the dot-product as <span class="math inline">\(\frac{\mathbf{x}\cdot\mathbf{y}}{\|\mathbf{y}\|}\)</span> .</p>
</section>
<section id="matrices" class="level2">
<h2 class="anchored" data-anchor-id="matrices">Matrices</h2>
<p>A <strong>matrix</strong> is a 2-dimensional collection of numbers. We will denote matrices using bold capital letters, e.g.&nbsp;<span class="math inline">\(\mathbf{A}\)</span>.</p>
<p><span class="math display">\[
\mathbf{A} = \begin{bmatrix} 3 &amp; 5 &amp; 4 \\ 1 &amp; 1 &amp; 2  \end{bmatrix}
\]</span></p>
<p>In numpy we can create a matrix by passing <code>np.array</code> as list-of-lists, where each inner list specifies a <em>row</em> of the matrix.</p>
<div id="b606e262" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">4</span>], [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>]])</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>array([[3, 5, 4],
       [1, 1, 2]])</code></pre>
</div>
</div>
</section>
<section id="matrix-elements" class="level2">
<h2 class="anchored" data-anchor-id="matrix-elements">Matrix elements</h2>
<p>As with vectors we will denote individual elements of a matrix using subscripts. In this case, each element has 2 coordinates. Conventions is to always list the <em>row</em> <em>first</em>.</p>
<p><span class="math display">\[
\mathbf{A} = \begin{bmatrix} A_{11} &amp; A_{12} &amp; A_{13} \\ A_{21} &amp; A_{22} &amp; A_{23} \end{bmatrix}
\]</span></p>
<p>In numpy we can access elements in a matrix similarly.</p>
<div id="5b90bb40" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>A[<span class="dv">1</span>, <span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>np.int64(2)</code></pre>
</div>
</div>
<p>As with vectors, we say that two matrices are <em>equal</em> if and only if all of the corresponding elements are equal.</p>
</section>
<section id="matrix-creation-in-numpy" class="level2">
<h2 class="anchored" data-anchor-id="matrix-creation-in-numpy">Matrix creation in Numpy</h2>
<p><strong>Basic creation functions</strong></p>
<div id="4f6280ac" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>A0 <span class="op">=</span> np.zeros((<span class="dv">3</span>, <span class="dv">4</span>))          <span class="co"># create a 3x4 matrix of all zeros</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>A1 <span class="op">=</span> np.ones((<span class="dv">4</span>, <span class="dv">4</span>))           <span class="co"># create a 4x4 matrix of all ones</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>Ainf <span class="op">=</span> np.full((<span class="dv">3</span>, <span class="dv">3</span>), np.inf) <span class="co"># create a 3x3 matrix of all infinities</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>I <span class="op">=</span> np.eye(<span class="dv">3</span>)                  <span class="co"># create a 3x3 itentity matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Creating a matrix by “reshaping” a vector with the same number of elements</strong></p>
<div id="22bfedf5" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>V <span class="op">=</span> np.arange(<span class="dv">1</span>, <span class="dv">13</span>).reshape((<span class="dv">3</span>, <span class="dv">4</span>)) <span class="co"># Create a 3x4 matrix with elements 1-12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Creating matrices by combining matrices</strong></p>
<div id="82627de9" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> np.tile(A0, (<span class="dv">3</span>, <span class="dv">2</span>))               <span class="co"># create a matrix by "tiling" copies of A0 (3 copies by 2 copies)</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> np.concatenate([A0, A1], axis<span class="op">=</span><span class="dv">0</span>)  <span class="co"># create a (2n x m) matrix by stacking two matrices vertically</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> np.concatenate([A0, I], axis<span class="op">=</span><span class="dv">1</span>)  <span class="co"># create a (n x 2m) matrix by stacking two matrices horizontally</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="slicing-matrices" class="level2">
<h2 class="anchored" data-anchor-id="slicing-matrices">Slicing matrices</h2>
<p>Often we will refer to an entire row of a matrix (which is itself a vector) using matrix notation with a single index</p>
<p><span class="math display">\[
\mathbf{A}_i = \begin{bmatrix} A_{i1} \\ A_{i2} \\ \vdots \end{bmatrix}
\]</span></p>
<p>In numpy we can access a single row similarly.</p>
<div id="a9fe9711" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>A[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>array([1, 1, 2])</code></pre>
</div>
</div>
</section>
<section id="slicing-matrices-1" class="level2">
<h2 class="anchored" data-anchor-id="slicing-matrices-1">Slicing matrices</h2>
<p>We can refer to an entire <em>column</em> by replacing the row index with a <span class="math inline">\(*\)</span>, indicating we are referring to <em>all</em> rows in that column.</p>
<p><span class="math display">\[
\mathbf{A}_{*i} = \begin{bmatrix} A_{1i} \\ A_{2i} \\ \vdots \end{bmatrix}
\]</span></p>
<p>In numpy we can access an entire column (or row) using the <em>slice</em> operator <code>:</code>, which takes all elements along an axis.</p>
<div id="4437cf91" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>A[:, <span class="dv">1</span>] <span class="co"># Take all elements in column 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>array([5, 1])</code></pre>
</div>
</div>
</section>
<section id="slicing-matrices-2" class="level2">
<h2 class="anchored" data-anchor-id="slicing-matrices-2">Slicing matrices</h2>
<p>We can also use the slice operator to take a subset of elements along an axis.</p>
<div id="6445f720" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>A[:, <span class="dv">1</span>:<span class="dv">3</span>] <span class="co">#Take the second and third columns of A</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>array([[5, 4],
       [1, 2]])</code></pre>
</div>
</div>
</section>
<section id="advanced-slicing-in-numpy" class="level2">
<h2 class="anchored" data-anchor-id="advanced-slicing-in-numpy">Advanced slicing in numpy</h2>
<p><strong>Open-ended slices</strong></p>
<div id="0362acd8" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"A[:2]="</span>, A[:<span class="dv">2</span>]) <span class="co"># Take rows up to 2 (not inucluding 2)</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"A[1:]="</span>, A[<span class="dv">1</span>:]) <span class="co"># Take rows starting at (and including) 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A[:2]= [[1 2 3 4]
 [5 6 7 8]]
A[1:]= [[ 5  6  7  8]
 [ 9 10 11 12]]</code></pre>
</div>
</div>
<p><strong>Taking rows and colmns</strong></p>
<div id="73d98f45" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"A[0, :]="</span>, A[<span class="dv">0</span>, :])   <span class="co"># first row, all columns</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"A[:, 1]="</span>, A[:, <span class="dv">1</span>])   <span class="co"># all rows, second column</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"A[-1, :]"</span>, A[<span class="op">-</span><span class="dv">1</span>, :])  <span class="co"># all columns of the last row</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"A[:, -2]"</span>, A[:, <span class="op">-</span><span class="dv">2</span>])  <span class="co"># second to last column of every row</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A[0, :]= [1 2 3 4]
A[:, 1]= [ 2  6 10]
A[-1, :] [ 9 10 11 12]
A[:, -2] [ 3  7 11]</code></pre>
</div>
</div>
</section>
<section id="advanced-slicing-in-numpy-1" class="level2">
<h2 class="anchored" data-anchor-id="advanced-slicing-in-numpy-1">Advanced slicing in numpy</h2>
<p><strong>More general slicing with steps</strong></p>
<div id="f4b6063e" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"A[1,0:2]="</span>, A[<span class="dv">1</span>,<span class="dv">0</span>:<span class="dv">2</span>])</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"A[0,0:4:2]="</span>, A[<span class="dv">0</span>,<span class="dv">0</span>:<span class="dv">4</span>:<span class="dv">2</span>])</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"A[:,0:4:2]=</span><span class="ch">\n</span><span class="st">"</span>, A[:,<span class="dv">0</span>:<span class="dv">4</span>:<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A[1,0:2]= [5 6]
A[0,0:4:2]= [1 3]
A[:,0:4:2]=
 [[ 1  3]
 [ 5  7]
 [ 9 11]]</code></pre>
</div>
</div>
<p><strong>Taking one row and selected columns</strong></p>
<div id="a3094f62" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"A[2, [1,4]]="</span>,A[<span class="dv">2</span>, [<span class="dv">0</span>,<span class="dv">3</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A[2, [1,4]]= [ 9 12]</code></pre>
</div>
</div>
<p><strong>Taking all rows and selected columns</strong></p>
<div id="bf83922f" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"A[:, [1,4]]=</span><span class="ch">\n</span><span class="st">"</span>,A[:, [<span class="dv">0</span>,<span class="dv">3</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A[:, [1,4]]=
 [[ 1  4]
 [ 5  8]
 [ 9 12]]</code></pre>
</div>
</div>
</section>
<section id="matrix-shapes" class="level2">
<h2 class="anchored" data-anchor-id="matrix-shapes">Matrix shapes</h2>
<p>The matrix <span class="math inline">\(\mathbf{A}\)</span> above has 2 rows and 3 columns, thus we would specify it’s <em>shape</em> as <span class="math inline">\(2\times3\)</span>. A <em>square matrix</em> has the same number of rows and columns.</p>
<p><span class="math display">\[
\mathbf{A} = \begin{bmatrix} 3 &amp; 5 &amp; 4 \\ 1 &amp; 1 &amp; 2 \\ 4 &amp; 1 &amp; 3 \end{bmatrix}
\]</span></p>
<p>We can access the shape of a matrix in numpy using its <code>shape</code> property.</p>
<div id="dd0b97d0" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">4</span>], [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">3</span>]])</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(3, 3)</code></pre>
</div>
</div>
</section>
<section id="matrix-transpose" class="level2">
<h2 class="anchored" data-anchor-id="matrix-transpose">Matrix transpose</h2>
<p>The <strong>transpose</strong> of a matrix is an operation that swaps the rows and columns of the matrix. We denote the transpose of a matrix <span class="math inline">\(\mathbf{A}\)</span> as <span class="math inline">\(\mathbf{A}^T\)</span>.</p>
<p><span class="math display">\[
\mathbf{A} = \begin{bmatrix} A_{11} &amp; A_{12} &amp; A_{13} \\ A_{21} &amp; A_{22} &amp; A_{23} \end{bmatrix}, \quad \mathbf{A}^T = \begin{bmatrix} A_{11} &amp; A_{21} \\  A_{12} &amp; A_{22} \\  A_{13} &amp; A_{23} \end{bmatrix}
\]</span></p>
<p>In numpy we can transpose a matrix by using the <code>T</code> property.</p>
<div id="d150d5ad" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>]])</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>A.T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>array([[1, 2],
       [1, 2],
       [1, 2]])</code></pre>
</div>
</div>
</section>
<section id="element-wise-matrix-operations" class="level2">
<h2 class="anchored" data-anchor-id="element-wise-matrix-operations">Element-wise matrix operations</h2>
<p>As with vectors, many operations on matrices are performed <em>element-wise</em>:</p>
<p><span class="math display">\[
\mathbf{A} + \mathbf{B} = \begin{bmatrix} A_{11} + B_{11}  &amp; A_{12} + B_{12} &amp; A_{13} + B_{13} \\ A_{21} + B_{21} &amp; A_{22} + B_{22} &amp; A_{23} + B_{23} \end{bmatrix}, \quad \log\mathbf{A} = \begin{bmatrix} \log A_{11}  &amp; \log A_{12} &amp; \log A_{13} \\ \log A_{21} &amp; \log A_{22} &amp; \log A_{23} \end{bmatrix}
\]</span></p>
<p>Scalar-matrix operation are also element-wise:</p>
<p><span class="math display">\[
c\mathbf{A} = \begin{bmatrix} cA_{11}  &amp; cA_{12} &amp; cA_{13} \\ cA_{21} &amp; cA_{22} &amp; cA_{23} \end{bmatrix}
\]</span></p>
<p>In numpy:</p>
<div id="187ca5de" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> <span class="dv">5</span> <span class="op">*</span> A </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">+</span> B</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>array([[ 6,  6,  6],
       [12, 12, 12]])</code></pre>
</div>
</div>
</section>
<section id="matrix-vector-products" class="level2">
<h2 class="anchored" data-anchor-id="matrix-vector-products">Matrix-vector products</h2>
<p>A matrix-vector product is an operation between a matrix and a vector that produces a new vector. Given a matrix <span class="math inline">\(\mathbf{A}\)</span> and a vector <span class="math inline">\(\mathbf{x}\)</span>, we write the matrix-vector product as:</p>
<p><span class="math display">\[
\mathbf{A}\mathbf{x} = \begin{bmatrix} A_{11} &amp; A_{12} &amp; A_{13} \\ A_{21} &amp; A_{22} &amp; A_{23} \\ A_{23} &amp; A_{32} &amp; A_{33} \end{bmatrix} \begin{bmatrix} x_1\\ x_2\\ x_3\end{bmatrix} = \begin{bmatrix} \sum_{i=1}^n x_i A_{1i} \\  \sum_{i=1}^n x_i A_{2i} \\  \sum_{i=1}^n x_i A_{3i} \end{bmatrix} = \begin{bmatrix} \mathbf{x}\cdot  \mathbf{A}_{1} \\ \mathbf{x}\cdot  \mathbf{A}_{2} \\ \mathbf{x} \cdot \mathbf{A}_{2} \end{bmatrix}
\]</span></p>
<p>In other words, each entry of the resulting vector is the dot product between <span class="math inline">\(\mathbf{x}\)</span> and a row of <span class="math inline">\(A\)</span>. In numpy we also use <code>np.dot</code> for matrix-vector products:</p>
<div id="fce7dd84" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">4</span>], [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">3</span>]])</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array([<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">1</span>])</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>np.dot(A, x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>array([35,  9, 16])</code></pre>
</div>
</div>
<p>Geometrically the matrix <span class="math inline">\(A\)</span> defines a transformation that scales and rotates any vector <span class="math inline">\(\mathbf{x}\)</span> about the origin.</p>
</section>
<section id="matrix-vector-products-1" class="level2">
<h2 class="anchored" data-anchor-id="matrix-vector-products-1">Matrix-vector products</h2>
<p>The number of columns of <span class="math inline">\(A\)</span> must match the size of the vector <span class="math inline">\(\mathbf{x}\)</span>, but if <span class="math inline">\(A\)</span> has a different number of rows, the output will simply have a different size.</p>
<div id="b6bfc540" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>np.dot(A[:<span class="dv">2</span>], x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>array([35,  9])</code></pre>
</div>
</div>
</section>
<section id="matrix-multiplication" class="level2">
<h2 class="anchored" data-anchor-id="matrix-multiplication">Matrix multiplication</h2>
<p><strong>Matrix multiplication</strong> is a fundamental operation between two matrices. It is defined as:</p>
<p><span class="math display">\[
\mathbf{A}\mathbf{B}  = \begin{bmatrix} A_{11} &amp; A_{12} &amp; A_{13} \\ A_{21} &amp; A_{22} &amp; A_{23} \\ A_{23} &amp; A_{32} &amp; A_{33} \end{bmatrix} \begin{bmatrix} B_{11} &amp; B_{12} \\ B_{21} &amp; B_{22} \\ B_{31} &amp; B_{32} \end{bmatrix}  =\begin{bmatrix} \sum_{i=1}^n A_{1i} B_{i1} &amp; \sum_{i=1}^n A_{i1}B_{i2} \\  \sum_{i=1}^n A_{2i}B_{i1} &amp; \sum_{i=1}^n A_{2i}B_{i2}  \\  \sum_{i=1}^n A_{3i}B_{i1} &amp; \sum_{i=1}^n A_{3i}B_{i2} \end{bmatrix} = \begin{bmatrix} \mathbf{A}_{1} \cdot \mathbf{B}_{*1} &amp; \mathbf{A}_{1} \cdot \mathbf{B}_{*2} \\ \mathbf{A}_{2} \cdot \mathbf{B}_{*1} &amp; \mathbf{A}_{2} \cdot \mathbf{B}_{*2}  \\ \mathbf{A}_{1} \cdot \mathbf{B}_{*1} &amp; \mathbf{A}_{1} \cdot \mathbf{B}_{*2}  \end{bmatrix}
\]</span></p>
<p>This means that if we multiply an <span class="math inline">\(n\times m\)</span> matrix <span class="math inline">\(\mathbf{A}\)</span> with an <span class="math inline">\(m\times k\)</span> matrix <span class="math inline">\(\mathbf{B}\)</span> we get an <span class="math inline">\(n\times k\)</span> matrix <span class="math inline">\(\mathbf{C}\)</span>, such that <span class="math inline">\(\mathbf{C}_{ij}\)</span> is the dot product of the <span class="math inline">\(i\)</span>-th row of <span class="math inline">\(\mathbf{A}\)</span> with the <span class="math inline">\(j\)</span>-th row of <span class="math inline">\(\mathbf{B}\)</span>.</p>
<p>In numpy we once again use the <code>np.dot</code> function to perform matrix-multiplications.</p>
<div id="8c4e435b" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> np.array([[<span class="dv">2</span>, <span class="op">-</span><span class="dv">1</span>], [<span class="dv">3</span>, <span class="dv">1</span>], [<span class="op">-</span><span class="dv">2</span>, <span class="dv">5</span>]])</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>C <span class="op">=</span> np.dot(A, B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="matrix-multiplication-1" class="level2">
<h2 class="anchored" data-anchor-id="matrix-multiplication-1">Matrix multiplication</h2>
<p>The number of rows of <span class="math inline">\(\mathbf{A}\)</span> must match the number of columns of <span class="math inline">\(\mathbf{B}\)</span> for the matrix multiplication <span class="math inline">\(\mathbf{A}\mathbf{B}\)</span> to be defined. This implies that matrix multiplication is <em>non-communitive:</em></p>
<p><span class="math display">\[
\mathbf{A}\mathbf{B}\neq \mathbf{B}\mathbf{A}
\]</span></p>
<p>However matrix multiplication is <em>associative</em> and <em>distributive</em>:</p>
<p><span class="math display">\[
\mathbf{A}(\mathbf{B}\mathbf{C})=(\mathbf{A}\mathbf{B})\mathbf{C}, \quad \mathbf{A}(\mathbf{B} +\mathbf{C}) = \mathbf{A}\mathbf{B} + \mathbf{A}\mathbf{C}
\]</span></p>
</section>
<section id="matrix-multiplication-2" class="level2">
<h2 class="anchored" data-anchor-id="matrix-multiplication-2">Matrix multiplication</h2>
<p>Matrix multiplication is a <em>composition</em> of linear maps, meaning that if we take the product <span class="math inline">\(\mathbf{A}\mathbf{B}\)</span> and apply the resulting matrix to a vector <span class="math inline">\(\mathbf{x}\)</span>, it is equivalent to first transforming <span class="math inline">\(\mathbf{x}\)</span> with <span class="math inline">\(\mathbf{B}\)</span> and then with <span class="math inline">\(\mathbf{A}\)</span>. We can state this succinctly as:</p>
<p><span class="math display">\[
(\mathbf{A}\mathbf{B})\mathbf{x} = \mathbf{A}(\mathbf{B}\mathbf{x})
\]</span></p>
<p>We can see this in numpy:</p>
<div id="d92335cf" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">3</span>])</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>np.dot(np.dot(A, B), x), np.dot(A, np.dot(B, x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>(array([79, 31, 41]), array([79, 31, 41]))</code></pre>
</div>
</div>
</section>
<section id="element-wise-multiplication" class="level2">
<h2 class="anchored" data-anchor-id="element-wise-multiplication">Element-wise multiplication</h2>
<p>It is important to note that in numpy the <code>*</code> operator does <strong>not</strong> perform matrix multiplication, instead it performs element-wise multiplication for both matrices and vectors.</p>
<div id="42aa79fd" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">2</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">3</span>]])</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">1</span>, <span class="dv">2</span>]])</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>A <span class="op">*</span> B</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>array([[1, 2],
       [2, 4],
       [3, 6]])</code></pre>
</div>
</div>
<p>In mathematical notation we will denote element-wise multiplication as:</p>
<p><span class="math display">\[
\mathbf{A} \odot \mathbf{B} = \begin{bmatrix} A_{11} B_{11}  &amp; A_{12}  B_{12} &amp; A_{13}  B_{13} \\ A_{21}  B_{21} &amp; A_{22}  B_{22} &amp; A_{23}  B_{23} \end{bmatrix}
\]</span></p>
</section>
<section id="matrix-reductions" class="level2">
<h2 class="anchored" data-anchor-id="matrix-reductions">Matrix reductions</h2>
<p>As we saw with vectors, we can take the <strong>sum</strong> of the elements of a matrix using the <code>np.sum</code> function:</p>
<div id="c139a240" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">sum</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>np.int64(12)</code></pre>
</div>
</div>
<p>The result is a scalar of the form:</p>
<p><span class="math display">\[
\text{sum}(\mathbf{A}) = \sum_{i=1}^n\sum_{j=1}^m A_{ij}
\]</span></p>
</section>
<section id="matrix-reductions-1" class="level2">
<h2 class="anchored" data-anchor-id="matrix-reductions-1">Matrix reductions</h2>
<p>In many cases we may wish to take the sum <em>along an axis</em> of a matrix. This operation results in a vector where each entry is the sum of elements from the corresponding row or column of the matrix.</p>
<p><span class="math display">\[
\text{rowsum}(\mathbf{A}) = \begin{bmatrix} \sum_{i=1}^n A_{i1} \\ \sum_{i=1}^n A_{i2} \\ \sum_{i=1}^n A_{i3} \\ \vdots\end{bmatrix}, \quad \text{colsum}(\mathbf{A}) = \begin{bmatrix} \sum_{j=1}^m A_{1j} \\ \sum_{j=1}^m A_{2j} \\ \sum_{j=1}^m A_{3j} \\ \vdots\end{bmatrix}
\]</span></p>
<p>In numpy we can specify a sum along an axis by providing an <code>axis</code> argument to <code>np.sum</code>. Setting <code>axis=0</code> specifies a row-sum, while <code>axis=1</code> specifies a column sum.</p>
<div id="6bbbdb70" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">2</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">3</span>]])</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">sum</span>(A, axis<span class="op">=</span><span class="dv">0</span>), np.<span class="bu">sum</span>(A, axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1 1]
 [2 2]
 [3 3]]</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>(array([6, 6]), array([2, 4, 6]))</code></pre>
</div>
</div>
</section>
<section id="other-matrix-reduction-examples" class="level2">
<h2 class="anchored" data-anchor-id="other-matrix-reduction-examples">Other matrix reduction examples</h2>
<div id="038f0877" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.mean(A))            <span class="co"># Take the mean of all elements in x</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.std(A, axis<span class="op">=</span><span class="dv">0</span>))     <span class="co"># Take the standard deviation of each column of x</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.<span class="bu">min</span>(A, axis<span class="op">=</span><span class="dv">1</span>))     <span class="co"># Find the minimum element in each row of x</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.<span class="bu">max</span>(A))             <span class="co"># Find the maximum element in x</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2.0
[0.81649658 0.81649658]
[1 2 3]
3</code></pre>
</div>
</div>
</section>
<section id="identity-matrices" class="level2">
<h2 class="anchored" data-anchor-id="identity-matrices">Identity Matrices</h2>
<p>The identity matrix, denoted at <span class="math inline">\(\mathbf{I}\)</span> is a special type of square matrix. It is defined as the matrix with <span class="math inline">\(1\)</span> for every diagonal element (<span class="math inline">\(\mathbf{I}_{i=j}=1\)</span>) and <span class="math inline">\(0\)</span> for every other element (<span class="math inline">\(\mathbf{I}_{i\neq j}=0\)</span>). A <span class="math inline">\(3\times 3\)</span> identity matrix looks like:</p>
<p><span class="math display">\[\mathbf{I} = \begin{bmatrix}1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1\end{bmatrix}\]</span></p>
<p>The identify matrix has the unique property that any appropriately sized matrix (or vector) multiplied with <span class="math inline">\(\mathbf{I}\)</span> will equal itself:</p>
<p><span class="math display">\[
\mathbf{I}\mathbf{A} = \mathbf{A}
\]</span></p>
<p>If we think of matrices as linear mappings the <em>identity</em> matrix simply maps any vector to itself.</p>
<p><span class="math display">\[
\mathbf{I} \mathbf{x} = \mathbf{x}
\]</span></p>
<p>In numpy we can create an identity matrix using the <code>np.eye</code> function:</p>
<div id="389a9f3d" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>I <span class="op">=</span> np.eye(<span class="dv">3</span>) <span class="co"># Create a 3x3 identity matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="solving-systems-of-linear-equations" class="level2">
<h2 class="anchored" data-anchor-id="solving-systems-of-linear-equations">Solving systems of linear equations</h2>
<p>Consider the matrix-vector product between a matrix <span class="math inline">\(\mathbf{A}\)</span> and a vector <span class="math inline">\(\mathbf{x}\)</span>, we can denote the result of this multiplication as <span class="math inline">\(\mathbf{b}\)</span>:</p>
<p><span class="math display">\[
\mathbf{A}\mathbf{x} =\mathbf{b}
\]</span></p>
<p>In many common cases we will know the matrix <span class="math inline">\(\mathbf{A}\)</span> and the vector <span class="math inline">\(\mathbf{b}\)</span>, but <em>not</em> the vector <span class="math inline">\(\mathbf{x}\)</span>. In such cases we need to <em>solve</em> this equation for <span class="math inline">\(\mathbf{x}\)</span>:</p>
<p><span class="math display">\[
\begin{bmatrix} A_{11} &amp; A_{12} &amp; A_{13} \\ A_{21} &amp; A_{22} &amp; A_{23} \\ A_{23} &amp; A_{32} &amp; A_{33} \end{bmatrix} \begin{bmatrix} \textbf{?}\\ \textbf{?}\\ \textbf{?}\end{bmatrix} = \begin{bmatrix} b_1 \\  b_2 \\  b_3 \end{bmatrix}
\]</span></p>
<p>In Numpy:</p>
<div id="d13b1a5e" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">3</span>, <span class="dv">1</span>], [<span class="op">-</span><span class="dv">1</span>, <span class="dv">4</span>]])</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array([<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>])</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linalg.solve(A, b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that in some cases there may not be any <span class="math inline">\(\mathbf{x}\)</span> that satisfies the equation (or there may be infinitely many). The conditions for this are beyond the scope of this course.</p>
</section>
<section id="inverse-matrices" class="level2">
<h2 class="anchored" data-anchor-id="inverse-matrices">Inverse matrices</h2>
<p>The <em>inverse</em> of a square matrix is denoted by <span class="math inline">\(\mathbf{A}^{-1}\)</span> and is defined as the matrix such that:</p>
<p><span class="math display">\[
\mathbf{A}\mathbf{A}^{-1} = \mathbf{I}
\]</span></p>
<p>This corresponds to the <em>inverse</em> of the linear map defined by <span class="math inline">\(\mathbf{A}\)</span>. Any vector transformed by <span class="math inline">\(\mathbf{A}\)</span> can be transformed back by applying the inverse matrix:</p>
<p><span class="math display">\[
\mathbf{A}^{-1}\left(\mathbf{A}\mathbf{x}\right) =\mathbf{x}
\]</span></p>
<p>We can also write the solution to a system of linear equations in terms of the inverse, by multiplying both sides by <span class="math inline">\(\mathbf{A}^{-1}\)</span>:</p>
<p><span class="math display">\[
\mathbf{A}\mathbf{x}=\mathbf{b}\quad \longrightarrow \quad \mathbf{A}^{-1}(\mathbf{A}\mathbf{x})=\mathbf{A}^{-1}\mathbf{b} \quad \longrightarrow \quad \mathbf{x}=\mathbf{A}^{-1}\mathbf{b}
\]</span></p>
<p>In numpy we can find the inverse of a matrix using the <code>np.linalg.inv</code> function:</p>
<div id="a6ccd5bb" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>A_inv <span class="op">=</span> np.linalg.inv(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that not every matrix has an inverse! Again, we won’t worry about these cases for now.</p>
</section>
</section>
<section id="calculus-prerequisites" class="level1">
<h1>Calculus prerequisites</h1>
<p>In addition to linear algebra, we will need a number of fundamental concepts from calculus throughout this course. We will review them here.</p>
<section id="functions" class="level2">
<h2 class="anchored" data-anchor-id="functions">Functions</h2>
<p>A <strong>function</strong> is a general mapping from one set to another.</p>
<p><span class="math display">\[
y=f(x),\quad f:\mathbb{R}\rightarrow\mathbb{R}
\]</span></p>
<p>We can definite functions as compositions of simple operations. For example we could define a polynomial function as:</p>
<p><span class="math display">\[
f(x) = x^2 + 3x + 1
\]</span></p>
<p>In code we can implement functions as, well, functions:</p>
<div id="d8cfa5d0" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> x <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>f(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>41</code></pre>
</div>
</div>
</section>
<section id="derivatives" class="level2">
<h2 class="anchored" data-anchor-id="derivatives">Derivatives</h2>
<p>The <strong>derivative</strong> of a function at input <span class="math inline">\(x\)</span> defines how the function’s output changes as the input changes from <span class="math inline">\(x\)</span>. It is equivalent to the <em>slope</em> of the line tangent to the function at the input <span class="math inline">\(x\)</span>. We’ll use the notation <span class="math inline">\(\frac{df}{dx}\)</span> to denote the <em>derivative</em> of the function <span class="math inline">\(f\)</span> at input <span class="math inline">\(x\)</span>. Formally:</p>
<p><span class="math display">\[
\frac{df}{dx} = \underset{\epsilon\rightarrow0}{\lim} \frac{f(x+\epsilon) - f(x)}{\epsilon}
\]</span></p>
<p>Intunitively, this means if we change our input <span class="math inline">\(x\)</span> by some small amount <span class="math inline">\(\epsilon\)</span>, the output of our function will change by approximately <span class="math inline">\(\frac{df}{dx}\epsilon\)</span></p>
<p><span class="math display">\[
f(x+\epsilon) \approx f(x)+\frac{df}{dx}\epsilon
\]</span></p>
</section>
<section id="derivative-operator" class="level2">
<h2 class="anchored" data-anchor-id="derivative-operator">Derivative operator</h2>
<p>We can also use the notation <span class="math inline">\(\frac{d}{dx}\)</span> to denote the <em>derivative operator</em>. This means “find the derivative of the following expression with respect to <span class="math inline">\(x\)</span>”.</p>
<p><span class="math display">\[
\frac{d}{dx}f(x) = \frac{df}{dx}
\]</span></p>
</section>
<section id="derivative-functions" class="level2">
<h2 class="anchored" data-anchor-id="derivative-functions">Derivative functions</h2>
<p>We can also talk about the function that maps any input <span class="math inline">\(x\)</span> to the derivative <span class="math inline">\(\frac{df}{dx}\)</span> we call this the <em>derivative function</em> and denote it as <span class="math inline">\(f'(x)\)</span>. So:</p>
<p><span class="math display">\[
\frac{df}{dx}=f'(x)
\]</span></p>
<p>Given a function defined as a composition of basic operations, we can use a set of standard rules to find the corresponding derivative function. For example using the rules <span class="math inline">\(\frac{d}{dx}x^a=ax\)</span> , <span class="math inline">\(\frac{d}{dx}ax=a\)</span> and <span class="math inline">\(\frac{d}{dx}a=0\)</span>, we can derive the derivative function for the polynomial above:</p>
<p><span class="math display">\[
f(x) = x^2 + 3x + 1
\]</span></p>
<p><span class="math display">\[
f'(x) = 2x + 3
\]</span></p>
</section>
<section id="basic-derivative-rules" class="level2">
<h2 class="anchored" data-anchor-id="basic-derivative-rules">Basic derivative rules</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Operation</th>
<th>Derivative <span class="math inline">\(\frac{d}{dx}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(a\)</span></td>
<td><span class="math inline">\(0\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(ax\)</span></td>
<td><span class="math inline">\(a\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(x^a\)</span></td>
<td><span class="math inline">\(ax\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\log(x)\)</span></td>
<td><span class="math inline">\(\frac{1}{x}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(e^x\)</span></td>
<td><span class="math inline">\(e^x\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(f(x) + g(x)\)</span></td>
<td><span class="math inline">\(f'(x)+g'(x)\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(f(x)g(x)\)</span></td>
<td><span class="math inline">\(f'(x)g(x) + f(x)g'(x)\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\frac{f(x)}{g(x)}\)</span></td>
<td><span class="math inline">\(\frac{f'(x)g(x)-f(x)g'(x)}{g(x)^2}\)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="compositions-of-functions" class="level2">
<h2 class="anchored" data-anchor-id="compositions-of-functions">Compositions of functions</h2>
<p><em>Composing</em> two functions means to apply one function to the output of another, for example we could apply <span class="math inline">\(f\)</span> to the output of <span class="math inline">\(g\)</span>:</p>
<p><span class="math display">\[
y = f\big(g\left(x\right)\big)
\]</span></p>
<p>This is easily replicated in code:</p>
<div id="5ca76c50" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> x <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> g(x):</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">5</span> <span class="op">*</span> x <span class="op">-</span> <span class="dv">2</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>f(g(<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<pre><code>209</code></pre>
</div>
</div>
</section>
<section id="chain-rule" class="level2">
<h2 class="anchored" data-anchor-id="chain-rule">Chain rule</h2>
<p>The <strong>chain</strong> <strong>rule</strong> tells us how to find the derivative of a composition of functions like this. We can write the rule either in terms of derivatives or derivative functions</p>
<p><span class="math display">\[
\frac{d}{dx}f\big(g\left(x\right)\big) = \frac{df}{dg}\frac{dg}{dx} \quad \text{or} \quad \frac{d}{dx}f\big(g\left(x\right)\big) =  f'\big(g\left(x\right)\big)g'\left(x\right)
\]</span></p>
<p>Note that in our derivative notation we’re using <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> to denote the outputs of the respective functions.</p>
</section>
<section id="multivariate-functions" class="level2">
<h2 class="anchored" data-anchor-id="multivariate-functions">Multivariate functions</h2>
<p>A function does not need to be restricted to having a single input. We can specify a function with multiple inputs as follows:</p>
<p><span class="math display">\[
f(x, y, z) = x^2 + 3xy - \log(z)
\]</span></p>
<p>In code this would look like;</p>
<div id="4e35513a" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x, y, z):</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> y <span class="op">+</span> np.log(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="partial-derivatives" class="level2">
<h2 class="anchored" data-anchor-id="partial-derivatives">Partial derivatives</h2>
<p>A <strong>partial derivative</strong> is the derivative of a multiple-input function with respect to a single input, <em>assuming all other inputs are constant</em>.</p>
<p><span class="math display">\[
\frac{\partial f}{\partial x} = \underset{\epsilon\rightarrow0}{\lim} \frac{f(x+\epsilon, y, z) - f(x,y,z)}{\epsilon}, \quad \frac{\partial f}{\partial y} = \underset{\epsilon\rightarrow0}{\lim} \frac{f(x, y+\epsilon, z) - f(x,y,z)}{\epsilon}
\]</span></p>
<p>These partial derivatives tell us how the output of the function changes as we change each of the inputs individually.</p>
</section>
<section id="partial-derivative-functions" class="level2">
<h2 class="anchored" data-anchor-id="partial-derivative-functions">Partial derivative functions</h2>
<p>We can also specify partial derivative functions in the same way as derivative functions. We’ll use subscript notation to specify which input we are differentiating with respect to.</p>
<p><span class="math display">\[
\frac{\partial f}{\partial x} = f_x'(x, y, z)
\]</span></p>
<p>We can derive partial derivative functions using the same set of derivative rules:</p>
<p><span class="math display">\[
f(x, y, z) = x^2 + 3xy - \log(z)
\]</span></p>
<p><span class="math display">\[
f_x'(x, y, z) = 2x + 3y
\]</span></p>
<p><span class="math display">\[
f_y'(x, y, z) = 3x
\]</span></p>
<p><span class="math display">\[
f_z'(x, y, z) = -\frac{1}{z}
\]</span></p>
</section>
<section id="functions-of-vectors" class="level2">
<h2 class="anchored" data-anchor-id="functions-of-vectors">Functions of vectors</h2>
<p>We can also define functions that take vectors (or matrices) as inputs.</p>
<p><span class="math display">\[
y = f(\mathbf{x}) \quad f: \mathbb{R}^n \rightarrow \mathbb{R}
\]</span></p>
<p>Here <span class="math inline">\(f\)</span> is a mapping from length <span class="math inline">\(n\)</span> vectors to real numbers. As a concrete example we could define the function:</p>
<p><span class="math display">\[
f(\mathbf{x}) = \sum_{i=1}^n x_i^3 + 1
\]</span></p>
<p>Here’s the same function in numpy:</p>
<div id="bfaedcf9" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.<span class="bu">sum</span>(x <span class="op">**</span> <span class="dv">3</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>f(np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<pre><code>np.int64(37)</code></pre>
</div>
</div>
<p>Note that functions of vectors are equivalent to multiple-input functions, but with a more compact notation!</p>
</section>
<section id="gradients" class="level2">
<h2 class="anchored" data-anchor-id="gradients">Gradients</h2>
<p>The <strong>gradient</strong> of a vector-input function is a vector such that each element is the partial derivative of the function with respect to the corresponding element of the input vector. We’ll use the same notation as derivatives for gradients.</p>
<p><span class="math display">\[
\frac{df}{d\mathbf{x}} = \begin{bmatrix} \frac{\partial f}{\partial x_1} \\ \frac{\partial f}{\partial x_2} \\ \frac{\partial f}{\partial x_3} \\ \vdots \end{bmatrix}
\]</span></p>
<p>The gradient is a vector that <em>tangent</em> to the function <span class="math inline">\(f\)</span> at the input <span class="math inline">\(\mathbf{x}\)</span>. Just as with derivatives, this means that the gradient defines a <em>linear</em> <em>approximation</em> to the function at the point <span class="math inline">\(\mathbf{x}\)</span>.</p>
<p><span class="math display">\[
f(\mathbf{x}+\mathbf{\epsilon}) \approx f(\mathbf{x}) + \frac{df}{d\mathbf{x}} \cdot \mathbf{\epsilon}
\]</span></p>
</section>
<section id="gradient-functions" class="level2">
<h2 class="anchored" data-anchor-id="gradient-functions">Gradient functions</h2>
<p>Just as with derivatives and partial derivatives, we can define a <strong>gradient function</strong> that maps an input vector <span class="math inline">\(\mathbf{x}\)</span> to the gradient of the function <span class="math inline">\(f\)</span> at <span class="math inline">\(\mathbf{x}\)</span> as:</p>
<p><span class="math display">\[
\frac{df}{d\mathbf{x}}=\nabla f(\mathbf{x})
\]</span></p>
<p>Here <span class="math inline">\(\nabla f\)</span> is the gradient function for <span class="math inline">\(f\)</span>. If the function takes multiple vectors as input, we can specify the gradient function with respect to a particular input using subscript notation:</p>
<p><span class="math display">\[
\frac{df}{d\mathbf{x}}= \nabla_{\mathbf{x}} f(\mathbf{x}, \mathbf{y}), \quad \frac{df}{d\mathbf{y}}= \nabla_{\mathbf{y}} f(\mathbf{x}, \mathbf{y})
\]</span></p>
</section>
</section>
<section id="visualization-with-numpy-and-matplotlib" class="level1">
<h1>Visualization with NumPy and Matplotlib</h1>
<section id="getting-started" class="level2">
<h2 class="anchored" data-anchor-id="getting-started">Getting started</h2>
<p>The standard way to import MatPlotLib is:</p>
<div id="dacd0b25" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="scatterplots" class="level2">
<h2 class="anchored" data-anchor-id="scatterplots">Scatterplots</h2>
<p><strong>Plotting</strong> a scatter of data points:</p>
<div id="b990c28b" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>x_values <span class="op">=</span> np.random.rand(<span class="dv">1</span>,<span class="dv">10</span>)   <span class="co"># unformly in [0,1)</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>y_values <span class="op">=</span> np.random.randn(<span class="dv">1</span>,<span class="dv">10</span>)  <span class="co"># Gaussian distribution</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>plt.plot(x_values, y_values, <span class="st">'ko'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="slides_files/figure-html/cell-51-output-1.png" width="582" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The string determines the plot appearance -- in this case, black circles. You can use color strings (‘r’, ‘g’, ‘b’, ‘m’, ‘c’, ‘y’, ...) or use the “Color” keyword to specify an RGB color. Marker appearance (‘o’,‘s’,‘v’,‘.’, ...) controls how the points look.</p>
</section>
<section id="line-plots" class="level2">
<h2 class="anchored" data-anchor-id="line-plots">Line plots</h2>
<p>If we connect points using a line appearance specification (‘-’,‘--’,‘:’,...), it will not look very good, because the points are not ordered in any meaningful way. Let’s try a line plot using an ordered sequence of x values:</p>
<div id="fade977f" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>x_values <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">8</span>,<span class="dv">100</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>y_values <span class="op">=</span> np.sin(x_values)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>plt.plot(x_values,y_values,<span class="st">'b'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="slides_files/figure-html/cell-52-output-1.png" width="590" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>This is actually a plot of a large number of points (100), with no marker shape and connected by a solid line.</p>
</section>
<section id="multiple-plots" class="level2">
<h2 class="anchored" data-anchor-id="multiple-plots">Multiple plots</h2>
<p>For plotting multiple point sets or curves, you can pass more vectors into the plot function, or call the function multiple times:</p>
<div id="b783a446" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>x_values <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">8</span>,<span class="dv">100</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>y1 <span class="op">=</span> np.sin(x_values)         <span class="co"># sinusoidal function</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>y2 <span class="op">=</span> (x_values <span class="op">-</span> <span class="dv">3</span>)<span class="op">**</span><span class="dv">2</span> <span class="op">/</span> <span class="dv">12</span>   <span class="co"># a simple quadratic curve</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>y3 <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span>x_values <span class="op">-</span> <span class="fl">1.0</span>       <span class="co"># a simple linear function</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>plt.plot(x_values, y1, <span class="st">'b-'</span>, x_values, y2, <span class="st">'g--'</span>)<span class="op">;</span>  <span class="co"># plot two curves</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>plt.plot(x_values, y3, <span class="st">'r:'</span>)<span class="op">;</span> <span class="co"># add a curve to the plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="slides_files/figure-html/cell-53-output-1.png" width="582" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="plot-ranges" class="level2">
<h2 class="anchored" data-anchor-id="plot-ranges">Plot ranges</h2>
<p>You may want to explicitly set the plot ranges -- perhaps the most common pattern is to plot something, get the plot’s ranges, and then restore them later after plotting another function:</p>
<div id="177a7062" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>x_values <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">8</span>,<span class="dv">100</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>y1 <span class="op">=</span> np.sin(x_values)         <span class="co"># sinusoidal function</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>y3 <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span>x_values <span class="op">-</span> <span class="fl">1.0</span>       <span class="co"># a simple linear function</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>plt.plot(x_values, y1, <span class="st">'b-'</span>) </span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.axis()               <span class="co"># get the x and y axis ranges</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ax)</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a><span class="co"># now plot something else (which will change the axis ranges):</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>plt.plot(x_values, y3, <span class="st">'r:'</span>)<span class="op">;</span> <span class="co"># add the linear curve</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>plt.axis(ax)<span class="op">;</span>                 <span class="co"># restore the original plot's axis ranges</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(np.float64(-0.4), np.float64(8.4), np.float64(-1.099652011574681), np.float64(1.0998559934443881))</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="slides_files/figure-html/cell-54-output-2.png" width="590" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="histograms" class="level2">
<h2 class="anchored" data-anchor-id="histograms">Histograms</h2>
<p>Histograms are also useful visualizations:</p>
<div id="945de830" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>plt.hist(y2, bins<span class="op">=</span><span class="dv">20</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="slides_files/figure-html/cell-55-output-1.png" width="566" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The outputs of hist include the bin locations, the number of data in each bin, and the “handles” to the plot elements to manipulate their appearance, if desired.</p>
</section>
<section id="subplots-and-plot-sizes" class="level2">
<h2 class="anchored" data-anchor-id="subplots-and-plot-sizes">Subplots and plot sizes</h2>
<p>It is often useful to put more than one plot together in a group; you can do this using the subplot function. There are various options; for example, “sharex” and “sharey” allow multiple plots to share a single axis range (or, you can set it manually, of course).</p>
<div id="4a925c5a" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">3</span>, figsize<span class="op">=</span>(<span class="fl">8.0</span>, <span class="fl">2.0</span>))      <span class="co"># make a 1 x 3 grid of plots:</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(x_values, y1, <span class="st">'b-'</span>)<span class="op">;</span>   <span class="co"># plot y1 in the first subplot</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(x_values, y2, <span class="st">'g--'</span>)<span class="op">;</span>  <span class="co">#   y2 in the 2nd</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].plot(x_values, y3, <span class="st">'r:'</span>)<span class="op">;</span>   <span class="co">#   and y3 in the last</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="slides_files/figure-html/cell-56-output-1.png" width="656" height="189" class="figure-img"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>