<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.319">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>CS 152: Neural Networks - Lecture 1: Introduction to Neural Networks</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">CS 152: Neural Networks</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../calendar/calendar.html" rel="" target="">
 <span class="menu-text">Calendar</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/orgs/CS152-Neural-Networks-Fall-2023/repositories" rel="" target="">
 <span class="menu-text">Homeworks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://harveymuddcollege.instructure.com/courses/615/" rel="" target="">
 <span class="menu-text">Canvas</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/orgs/CS152-Neural-Networks-Fall-2023/" rel="" target="">
 <span class="menu-text">Github</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#linear-algebra-prerequisites" id="toc-linear-algebra-prerequisites" class="nav-link active" data-scroll-target="#linear-algebra-prerequisites">Linear algebra prerequisites</a>
  <ul class="collapse">
  <li><a href="#numpy" id="toc-numpy" class="nav-link" data-scroll-target="#numpy">Numpy</a></li>
  <li><a href="#scalars" id="toc-scalars" class="nav-link" data-scroll-target="#scalars">Scalars</a></li>
  <li><a href="#vectors" id="toc-vectors" class="nav-link" data-scroll-target="#vectors">Vectors</a></li>
  <li><a href="#vectors-as-data" id="toc-vectors-as-data" class="nav-link" data-scroll-target="#vectors-as-data">Vectors as data</a></li>
  <li><a href="#vector-equality" id="toc-vector-equality" class="nav-link" data-scroll-target="#vector-equality">Vector equality</a></li>
  <li><a href="#vector-addition" id="toc-vector-addition" class="nav-link" data-scroll-target="#vector-addition">Vector addition</a></li>
  <li><a href="#element-wise-operations" id="toc-element-wise-operations" class="nav-link" data-scroll-target="#element-wise-operations">Element-wise operations</a></li>
  <li><a href="#vector-magnitude" id="toc-vector-magnitude" class="nav-link" data-scroll-target="#vector-magnitude">Vector magnitude</a></li>
  <li><a href="#dot-products" id="toc-dot-products" class="nav-link" data-scroll-target="#dot-products">Dot products</a></li>
  <li><a href="#matrices" id="toc-matrices" class="nav-link" data-scroll-target="#matrices">Matrices</a></li>
  <li><a href="#slicing-matrices" id="toc-slicing-matrices" class="nav-link" data-scroll-target="#slicing-matrices">Slicing matrices</a></li>
  <li><a href="#matrix-shapes" id="toc-matrix-shapes" class="nav-link" data-scroll-target="#matrix-shapes">Matrix shapes</a></li>
  <li><a href="#matrix-transpose" id="toc-matrix-transpose" class="nav-link" data-scroll-target="#matrix-transpose">Matrix transpose</a></li>
  <li><a href="#element-wise-matrix-operations" id="toc-element-wise-matrix-operations" class="nav-link" data-scroll-target="#element-wise-matrix-operations">Element-wise matrix operations</a></li>
  <li><a href="#matrix-vector-products" id="toc-matrix-vector-products" class="nav-link" data-scroll-target="#matrix-vector-products">Matrix-vector products</a></li>
  <li><a href="#matrix-multiplication" id="toc-matrix-multiplication" class="nav-link" data-scroll-target="#matrix-multiplication">Matrix multiplication</a></li>
  <li><a href="#vector-notation" id="toc-vector-notation" class="nav-link" data-scroll-target="#vector-notation">Vector notation</a></li>
  <li><a href="#vector-notation-revisited" id="toc-vector-notation-revisited" class="nav-link" data-scroll-target="#vector-notation-revisited">Vector notation revisited</a></li>
  <li><a href="#element-wise-multiplication" id="toc-element-wise-multiplication" class="nav-link" data-scroll-target="#element-wise-multiplication">Element-wise multiplication</a></li>
  <li><a href="#matrix-reductions" id="toc-matrix-reductions" class="nav-link" data-scroll-target="#matrix-reductions">Matrix reductions</a></li>
  <li><a href="#identity-matrices" id="toc-identity-matrices" class="nav-link" data-scroll-target="#identity-matrices">Identity Matrices</a></li>
  <li><a href="#solving-systems-of-linear-equations" id="toc-solving-systems-of-linear-equations" class="nav-link" data-scroll-target="#solving-systems-of-linear-equations">Solving systems of linear equations</a></li>
  <li><a href="#inverse-matrices" id="toc-inverse-matrices" class="nav-link" data-scroll-target="#inverse-matrices">Inverse matrices</a></li>
  </ul></li>
  <li><a href="#calculus-prerequisites" id="toc-calculus-prerequisites" class="nav-link" data-scroll-target="#calculus-prerequisites">Calculus prerequisites</a>
  <ul class="collapse">
  <li><a href="#functions" id="toc-functions" class="nav-link" data-scroll-target="#functions">Functions</a></li>
  <li><a href="#derivatives" id="toc-derivatives" class="nav-link" data-scroll-target="#derivatives">Derivatives</a></li>
  <li><a href="#derivative-functions" id="toc-derivative-functions" class="nav-link" data-scroll-target="#derivative-functions">Derivative functions</a></li>
  <li><a href="#chain-rule" id="toc-chain-rule" class="nav-link" data-scroll-target="#chain-rule">Chain rule</a></li>
  <li><a href="#partial-derivatives" id="toc-partial-derivatives" class="nav-link" data-scroll-target="#partial-derivatives">Partial derivatives</a></li>
  <li><a href="#partial-derivative-functions" id="toc-partial-derivative-functions" class="nav-link" data-scroll-target="#partial-derivative-functions">Partial derivative functions</a></li>
  <li><a href="#functions-of-vectors" id="toc-functions-of-vectors" class="nav-link" data-scroll-target="#functions-of-vectors">Functions of vectors</a></li>
  <li><a href="#partial-derivatives-of-vectors" id="toc-partial-derivatives-of-vectors" class="nav-link" data-scroll-target="#partial-derivatives-of-vectors">Partial derivatives of vectors</a></li>
  <li><a href="#gradients" id="toc-gradients" class="nav-link" data-scroll-target="#gradients">Gradients</a></li>
  <li><a href="#gradient-functions" id="toc-gradient-functions" class="nav-link" data-scroll-target="#gradient-functions">Gradient functions</a></li>
  </ul></li>
  <li><a href="#visualization-with-numpy-and-matplotlib" id="toc-visualization-with-numpy-and-matplotlib" class="nav-link" data-scroll-target="#visualization-with-numpy-and-matplotlib">Visualization with NumPy and Matplotlib</a>
  <ul class="collapse">
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started">Getting started</a></li>
  <li><a href="#scatterplots-and-line-plots" id="toc-scatterplots-and-line-plots" class="nav-link" data-scroll-target="#scatterplots-and-line-plots">Scatterplots and line plots</a></li>
  <li><a href="#legends" id="toc-legends" class="nav-link" data-scroll-target="#legends">Legends</a></li>
  <li><a href="#histograms" id="toc-histograms" class="nav-link" data-scroll-target="#histograms">Histograms</a></li>
  <li><a href="#subplots-and-plot-sizes" id="toc-subplots-and-plot-sizes" class="nav-link" data-scroll-target="#subplots-and-plot-sizes">Subplots and plot sizes</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lecture 1: Introduction to Neural Networks</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="linear-algebra-prerequisites" class="level1">
<h1>Linear algebra prerequisites</h1>
<p>We will begin with a review of many of the basic concepts from linear algebra that we will need for this course. As we go through these concepts we will see how to implement them in Python.</p>
<section id="numpy" class="level2">
<h2 class="anchored" data-anchor-id="numpy">Numpy</h2>
<p><a href="https://numpy.org/"><strong>Numpy</strong></a> Is the linear algebra library that we will be using for much of this class (later on we will introduce <a href="https://pytorch.org/"><strong>PyTorch</strong></a>, which is more geared towards neural networks). The standard way to import Numpy is:</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The most basic object from Numpy that we will just is the <em>array</em> (<code>np.array</code>), which will represent vectors matrices and even higher-dimensional objects known as <em>tensors</em>.</p>
</section>
<section id="scalars" class="level2">
<h2 class="anchored" data-anchor-id="scalars">Scalars</h2>
<p><strong>Scalars</strong> are just single numbers. In our math we will typically denote scalars with a lower-case letter. For example, we might call a scalar <span class="math inline">\(x\)</span> and give it a value as <span class="math inline">\(x=3.5\)</span>. In code this would be written as:</p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="fl">3.5</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># or as a 0-dimensional numpy array</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array(<span class="fl">3.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In general, we will assume that scalars are <em>real numbers</em> meaning decimal numbers in the range <span class="math inline">\((-\infty, \infty)\)</span>. We can denote this as <span class="math inline">\(x \in \mathbb{R}\)</span>, meaning “<span class="math inline">\(x\)</span> is in the set of real numbers”.</p>
</section>
<section id="vectors" class="level2">
<h2 class="anchored" data-anchor-id="vectors">Vectors</h2>
<p><strong>Vectors</strong> are ordered lists of numbers, as shown below. We will typically denote vectors with <strong>bold</strong> lower case letters, such as <span class="math inline">\(\mathbf{x}\)</span>.</p>
<p><span class="math display">\[
\mathbf{x} = \begin{bmatrix} 2\\ 5\\ 1\end{bmatrix}
\]</span></p>
<p>This <strong>bold</strong> notation is common, but not universal, so expect that external resources may denote things differently!</p>
<p>In Numpy, we can create an array object representing a vector by passing <code>np.array</code> a list of numbers.</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array([<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Other useful vector creation functions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Constants:</strong></p>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.zeros(<span class="dv">5</span>) <span class="co"># Create a size 5 vector filled with zeros</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(a)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.ones(<span class="dv">5</span>) <span class="co"># Create a size 5 vector filled with ones</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0. 0. 0. 0. 0.]
[1. 1. 1. 1. 1.]</code></pre>
</div>
</div>
<p><strong>Integer ranges:</strong></p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>])</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(a)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># or equivalently, using Python iterables:</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.array( <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">8</span>) )</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(a)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># or the NumPy function np.arange:</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.arange(<span class="dv">1</span>, <span class="dv">8</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1 2 3 4 5 6 7]
[1 2 3 4 5 6 7]
[1 2 3 4 5 6 7]</code></pre>
</div>
</div>
<p><strong>Decimal ranges:</strong></p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.linspace(<span class="fl">1.0</span>, <span class="fl">7.0</span>, <span class="dv">4</span>) <span class="co"># length-4 vector interpolating between 1.0 and 7.0</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(b)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>c <span class="op">=</span> np.logspace(<span class="fl">0.0</span>, <span class="fl">2.0</span>, <span class="dv">5</span>) <span class="co"># length-7 vector interpolating between 10^0 and 10^2 logarithmically</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(c)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1. 3. 5. 7.]
[  1.           3.16227766  10.          31.6227766  100.        ]</code></pre>
</div>
</div>
<p><strong>Combining vectors</strong></p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> np.concatenate([b, c]) <span class="co"># length 4 + 7 vector with the elements of both b and c</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>The individual numbers in the vector are called the <em>entries</em> and we will refer to them individually as subscripted scalars: <span class="math inline">\(x_1, x_2,…,x_n\)</span>, where <span class="math inline">\(n\)</span> is the number of entries or <em>size</em> of the vector.</p>
<p><span class="math display">\[
\mathbf{x} = \begin{bmatrix} x_1\\ x_2\\ x_3\end{bmatrix}
\]</span></p>
<p>We may say that <span class="math inline">\(\mathbf{x} \in \mathbb{R}^n\)</span> to mean that <span class="math inline">\(\mathbf{x}\)</span> is in the set of vectors with <span class="math inline">\(n\)</span> real-valued entries. In numpy we can access individual elements of a vector using <code>[]</code> operators (note that numpy is 0-indexed!).</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="272">
<pre><code>2</code></pre>
</div>
</div>
<p>A vector represents either a <em>location</em> or a <em>change in location</em> in <span class="math inline">\(n\)</span> -dimensional space. For instance, the <span class="math inline">\(\mathbf{x}\)</span> vector we defined could represent the point with coordinates <span class="math inline">\((2, 5, 1)\)</span> in 3-D space or a movement of 2 along the first axis, 5 along the second axis and 1 along the third axis.</p>
<div class="cell" data-execution_count="10">
<div class="cell-output cell-output-display">
<p><img src="notes_files/figure-html/cell-11-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="vectors-as-data" class="level2">
<h2 class="anchored" data-anchor-id="vectors-as-data">Vectors as data</h2>
<p>Vectors do not necessarily need to represent geometric points or directions. As they are simply ordered collections of numbers, we can a vector to represent any type of data in a more formal way.</p>
<p>For example, a space of vectors could represent students, with each entry corresponding to a student’s grade in a different subject:</p>
<p><span class="math display">\[
\text{Student } \mathbf{x} = \begin{bmatrix} \text{Math} \\ \text{CS} \\ \text{Literature} \\\text{History} \end{bmatrix}
\]</span></p>
<p>Any two students might have different grades across the subjects. We can represent these two students (say <span class="math inline">\(\mathbf{x}_1\)</span> and <span class="math inline">\(\mathbf{x}_2\)</span>) as two vectors.</p>
<p><span class="math display">\[
\mathbf{x}_1 = \begin{bmatrix} 3.0 \\ 4.0 \\ 3.7 \\ 2.3 \end{bmatrix}, \quad \mathbf{x}_2 = \begin{bmatrix} 3.7 \\ 3.3 \\ 3.3 \\ 4.0 \end{bmatrix}
\]</span></p>
</section>
<section id="vector-equality" class="level2">
<h2 class="anchored" data-anchor-id="vector-equality">Vector equality</h2>
<p>We say that two vectors are <em>equal</em> if and only if all of the corresponding elements are equal, so <span class="math inline">\(\mathbf{x} = \mathbf{y}\)</span> implies that <span class="math inline">\(x_1=y_1, x_2=y_2…\)</span>. In numpy when we compare two vectors for equality, we get a new vector that indicates which entries are equal.</p>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array([<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">1</span>])</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.array([<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">2</span>])</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">==</span> y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="275">
<pre><code>array([False,  True, False])</code></pre>
</div>
</div>
<p>We can check if all entries are equal (and therefore the vectors are equal) using the <code>np.all</code> function.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">all</span>(x <span class="op">==</span> y), np.<span class="bu">all</span>(x <span class="op">==</span> x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="276">
<pre><code>(False, True)</code></pre>
</div>
</div>
<p>Other comparison operators (<code>&gt;</code>,<code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code>, <code>!=</code>) also perform element-wise comparison in numpy.</p>
</section>
<section id="vector-addition" class="level2">
<h2 class="anchored" data-anchor-id="vector-addition">Vector addition</h2>
<p>When we add or subtract vectors, we add or subtract the corresponding elements.</p>
<p><span class="math display">\[\mathbf{x} + \mathbf{y} = \begin{bmatrix} x_1\\ x_2\\ x_3\end{bmatrix} + \begin{bmatrix} y_1\\ y_2\\ y_3\end{bmatrix} = \begin{bmatrix} x_1 + y_1\\ x_2 + y_2\\ x_3 + y_3\end{bmatrix}\]</span> This works the same in numpy</p>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">+</span> y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="277">
<pre><code>array([ 5, 10,  3])</code></pre>
</div>
</div>
<p>This corresponds to <em>shifting</em> the point <span class="math inline">\(\mathbf{x}\)</span> by the vector <span class="math inline">\(\mathbf{y}\)</span>.</p>
<div class="cell" data-execution_count="14">
<div class="cell-output cell-output-display">
<p><img src="notes_files/figure-html/cell-15-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="element-wise-operations" class="level2">
<h2 class="anchored" data-anchor-id="element-wise-operations">Element-wise operations</h2>
<p>In both mathematical notation and numpy, most operations on vectors will be assumed to be taken <em>element-wise</em>. That is,</p>
<p><span class="math display">\[
\mathbf{x}^2 = \begin{bmatrix} x_1^2 \\ x_2^2 \\ x_3^2 \end{bmatrix} , \quad \log(\mathbf{x}) = \begin{bmatrix} \log x_1 \\ \log x_2 \\ \log x_3 \end{bmatrix},\ \text{etc.}
\]</span></p>
<p>In numpy:</p>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">**</span> <span class="dv">2</span>, np.log(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="279">
<pre><code>(array([ 4, 25,  1]), array([0.69314718, 1.60943791, 0.        ]))</code></pre>
</div>
</div>
<p>Note that in this class (and in numpy!) logarithms are assumed to be base <span class="math inline">\(e\)</span>, otherwise known as <em>natural logarithms</em>.</p>
<p>Operations between scalars and vectors are also assumed to be element-wise as in this scalar-vector multiplication</p>
<p><span class="math display">\[
a\mathbf{x} = \begin{bmatrix} a x_1 \\ a x_2 \\ a x_3 \end{bmatrix}, \quad a + \mathbf{x} = \begin{bmatrix} a + x_1 \\ a + x_2 \\ a + x_3 \end{bmatrix}
\]</span></p>
</section>
<section id="vector-magnitude" class="level2">
<h2 class="anchored" data-anchor-id="vector-magnitude">Vector magnitude</h2>
<p>The <em>magnitude</em> of a vector its length in <span class="math inline">\(\mathbb{R}^n\)</span>, or equivalently the Euclidean distance from the origin to the point the vector represents. It is denoted as<span class="math inline">\(\|\mathbf{x}\|_2\)</span> and defined as:</p>
<p><span class="math display">\[
\|\mathbf{x}\|_2 = \sqrt{\sum_{i=1}^n x_i^2}
\]</span></p>
<p>The subscript <span class="math inline">\(2\)</span> specifies that we are talking about Euclidean distance. Because of this we will also refer to the magnitude as the <em>two-norm</em>.</p>
<p>In numpy we can compute this using the <code>np.linalg.norm</code> function.</p>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>xnorm <span class="op">=</span> np.linalg.norm(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can also compute this explicitly with the <code>np.sum</code> function, which computes the sum of the elements of a vector.</p>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>xnorm_explicit <span class="op">=</span> np.sqrt(np.<span class="bu">sum</span>(x <span class="op">**</span> <span class="dv">2</span>))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>xnorm, xnorm_explicit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="281">
<pre><code>(5.477225575051661, 5.477225575051661)</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Other useful aggregation functions
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.mean(x))    <span class="co"># Take the mean of the elements in x</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.std(x))     <span class="co"># Take the standard deviation of the elements in x</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.<span class="bu">min</span>(x))     <span class="co"># Find the minimum element in x</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.<span class="bu">max</span>(x))     <span class="co"># Find the maximum element in x</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2.6666666666666665
1.699673171197595
1
5</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>A <strong>unit vector</strong> is a vector with length <span class="math inline">\(1\)</span>. We can find a unit vector that has the same <em>direction</em> as <span class="math inline">\(\mathbf{x}\)</span> by dividing <span class="math inline">\(\mathbf{x}\)</span> by it’s magnitude:</p>
<p><span class="math display">\[
\frac{\mathbf{x}}{\|\mathbf{x}\|_2}
\]</span></p>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">/</span> np.linalg.norm(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="283">
<pre><code>array([0.36514837, 0.91287093, 0.18257419])</code></pre>
</div>
</div>
</section>
<section id="dot-products" class="level2">
<h2 class="anchored" data-anchor-id="dot-products">Dot products</h2>
<p>The <strong>dot-product</strong> operation between two vectors is defined as</p>
<p><span class="math display">\[
\mathbf{x} \cdot \mathbf{y} = \sum_{i=1}^n x_i y_i
\]</span></p>
<p>More commonly in this class we will write the dot-product between the vectors <span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\mathbf{y}\)</span> as: <span class="math display">\[\mathbf{x}^T \mathbf{y} = \sum_{i=1}^n x_i y_i\]</span>$</p>
<p>The result of a dot product is a scalar whose value is equal to <span class="math inline">\(\|\mathbf{x}\|_2\|\mathbf{y}\|_2 \cos\theta\)</span>, where <span class="math inline">\(\theta\)</span> is the <em>angle</em> between them. If<span class="math inline">\(\theta=\frac{\pi}{2}\)</span>, the vectors are <em>orthogonal</em> and the dot product with be <span class="math inline">\(0\)</span>. If <span class="math inline">\(\theta&gt;\frac{\pi}{2}\)</span> or <span class="math inline">\(\theta &lt; -\frac{\pi}{2}\)</span> , the dot product will be negative.</p>
<p>If <span class="math inline">\(\theta=0\)</span> then <span class="math inline">\(\cos(\theta)=1\)</span>. In this case we say the vectors are <em>colinear</em>. This formulation implies that given two vectors of fixed length, the dot product is maximized with they are colinear ( <span class="math inline">\(\theta=0\)</span> ).</p>
<p>We can compute dot products in numpy using the <code>np.dot</code> function</p>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>np.dot(x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="284">
<pre><code>33</code></pre>
</div>
</div>
<p>Geometrically, <span class="math inline">\(\|\mathbf{x}\|_2\cos\theta\)</span> is the length of the <em>projection</em> of <span class="math inline">\(\mathbf{x}\)</span> onto <span class="math inline">\(\mathbf{y}\)</span>. Thus, we can compute the length of this projection using the dot-product as <span class="math inline">\(\frac{\mathbf{x}\cdot\mathbf{y}}{\|\mathbf{y}\|}\)</span> .</p>
</section>
<section id="matrices" class="level2">
<h2 class="anchored" data-anchor-id="matrices">Matrices</h2>
<p>A <strong>matrix</strong> is a 2-dimensional collection of numbers. We will denote matrices using bold capital letters, e.g.&nbsp;<span class="math inline">\(\mathbf{A}\)</span>.</p>
<p><span class="math display">\[
\mathbf{A} = \begin{bmatrix} 3 &amp; 5 &amp; 4 \\ 1 &amp; 1 &amp; 2  \end{bmatrix}
\]</span></p>
<p>In numpy we can create a matrix by passing <code>np.array</code> as list-of-lists, where each inner list specifies a <em>row</em> of the matrix.</p>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">4</span>], [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>]])</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>A</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="285">
<pre><code>array([[3, 5, 4],
       [1, 1, 2]])</code></pre>
</div>
</div>
<p>As with vectors we will denote individual elements of a matrix using subscripts. In this case, each element has 2 coordinates. Conventions is to always list the <em>row</em> <em>first</em>.</p>
<p><span class="math display">\[
\mathbf{A} = \begin{bmatrix} A_{11} &amp; A_{12} &amp; A_{13} \\ A_{21} &amp; A_{22} &amp; A_{23} \end{bmatrix}
\]</span></p>
<p>In numpy we can access elements in a matrix similarly.</p>
<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>A[<span class="dv">1</span>, <span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="286">
<pre><code>2</code></pre>
</div>
</div>
<p>As with vectors, we say that two matrices are <em>equal</em> if and only if all of the corresponding elements are equal.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Other matrix creation routines
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Basic creation functions</strong></p>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>A0 <span class="op">=</span> np.zeros((<span class="dv">3</span>, <span class="dv">4</span>))          <span class="co"># create a 3x4 matrix of all zeros</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>A1 <span class="op">=</span> np.ones((<span class="dv">4</span>, <span class="dv">4</span>))           <span class="co"># create a 4x4 matrix of all ones</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>Ainf <span class="op">=</span> np.full((<span class="dv">3</span>, <span class="dv">3</span>), np.inf) <span class="co"># create a 3x3 matrix of all infinities</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>I <span class="op">=</span> np.eye(<span class="dv">3</span>)                  <span class="co"># create a 3x3 itentity matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Creating a matrix by “reshaping” a vector with the same number of elements</strong></p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>V <span class="op">=</span> np.arange(<span class="dv">1</span>, <span class="dv">13</span>).reshape((<span class="dv">3</span>, <span class="dv">4</span>)) <span class="co"># Create a 3x4 matrix with elements 1-12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Creating matrices by combining matrices</strong></p>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> np.tile(A0, (<span class="dv">3</span>, <span class="dv">2</span>))               <span class="co"># create a matrix by "tiling" copies of A0 (3 copies by 2 copies)</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> np.concatenate([A0, A1], axis<span class="op">=</span><span class="dv">0</span>)  <span class="co"># create a (2n x m) matrix by stacking two matrices vertically</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> np.concatenate([A0, I], axis<span class="op">=</span><span class="dv">1</span>)  <span class="co"># create a (n x 2m) matrix by stacking two matrices horizontally</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="slicing-matrices" class="level2">
<h2 class="anchored" data-anchor-id="slicing-matrices">Slicing matrices</h2>
<p>Often we will refer to an entire row of a matrix (which is itself a vector) using matrix notation with a single index</p>
<p><span class="math display">\[
\mathbf{A}_i = \begin{bmatrix} A_{i1} \\ A_{i2} \\ \vdots \end{bmatrix}
\]</span></p>
<p>In numpy we can access a single row similarly.</p>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>A[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="290">
<pre><code>array([1, 1, 2])</code></pre>
</div>
</div>
<p>We can refer to an entire <em>column</em> by replacing the row index with a <span class="math inline">\(*\)</span>, indicating we are referring to <em>all</em> rows in that column.</p>
<p><span class="math display">\[
\mathbf{A}_{*i} = \begin{bmatrix} A_{1i} \\ A_{2i} \\ \vdots \end{bmatrix}
\]</span></p>
<p>In numpy we can access an entire column (or row) using the <em>slice</em> operator <code>:</code>, which takes all elements along an axis.</p>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>A[:, <span class="dv">1</span>] <span class="co"># Take all elements in column 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="291">
<pre><code>array([5, 1])</code></pre>
</div>
</div>
<p>We can also use the slice operator to take a subset of elements along an axis.</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>A[:, <span class="dv">1</span>:<span class="dv">3</span>] <span class="co">#Take the second and third columns of A</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="292">
<pre><code>array([[5, 4],
       [1, 2]])</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Advanced slicing in numpy
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.arange(<span class="dv">1</span>, <span class="dv">13</span>).reshape((<span class="dv">3</span>, <span class="dv">4</span>))</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[ 1  2  3  4]
 [ 5  6  7  8]
 [ 9 10 11 12]]</code></pre>
</div>
</div>
<p><strong>Open-ended slices</strong></p>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"A[:2]="</span>, A[:<span class="dv">2</span>]) <span class="co"># Take rows up to 2 (not inucluding 2)</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"A[1:]="</span>, A[<span class="dv">1</span>:]) <span class="co"># Take rows starting at (and including) 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A[:2]= [[1 2 3 4]
 [5 6 7 8]]
A[1:]= [[ 5  6  7  8]
 [ 9 10 11 12]]</code></pre>
</div>
</div>
<p><strong>Taking rows and colmns</strong></p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"A[0, :]="</span>, A[<span class="dv">0</span>, :])   <span class="co"># first row, all columns</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"A[:, 1]="</span>, A[:, <span class="dv">1</span>])   <span class="co"># all rows, second column</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"A[-1, :]"</span>, A[<span class="op">-</span><span class="dv">1</span>, :])  <span class="co"># all columns of the last row</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"A[:, -2]"</span>, A[:, <span class="op">-</span><span class="dv">2</span>])  <span class="co"># second to last column of every row</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A[0, :]= [1 2 3 4]
A[:, 1]= [ 2  6 10]
A[-1, :] [ 9 10 11 12]
A[:, -2] [ 3  7 11]</code></pre>
</div>
</div>
<p><strong>More general slicing with steps</strong></p>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"A[1,0:2]="</span>, A[<span class="dv">1</span>,<span class="dv">0</span>:<span class="dv">2</span>])</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"A[0,0:4:2]="</span>, A[<span class="dv">0</span>,<span class="dv">0</span>:<span class="dv">4</span>:<span class="dv">2</span>])</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"A[:,0:4:2]=</span><span class="ch">\n</span><span class="st">"</span>, A[:,<span class="dv">0</span>:<span class="dv">4</span>:<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A[1,0:2]= [5 6]
A[0,0:4:2]= [1 3]
A[:,0:4:2]=
 [[ 1  3]
 [ 5  7]
 [ 9 11]]</code></pre>
</div>
</div>
<p><strong>Taking one row and selected columns</strong></p>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"A[2, [1,4]]="</span>,A[<span class="dv">2</span>, [<span class="dv">0</span>,<span class="dv">3</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A[2, [1,4]]= [ 9 12]</code></pre>
</div>
</div>
<p><strong>Taking all rows and selected columns</strong></p>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"A[:, [1,4]]=</span><span class="ch">\n</span><span class="st">"</span>,A[:, [<span class="dv">0</span>,<span class="dv">3</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>A[:, [1,4]]=
 [[ 1  4]
 [ 5  8]
 [ 9 12]]</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="matrix-shapes" class="level2">
<h2 class="anchored" data-anchor-id="matrix-shapes">Matrix shapes</h2>
<p>The matrix <span class="math inline">\(\mathbf{A}\)</span> above has 2 rows and 3 columns, thus we would specify it’s <em>shape</em> as <span class="math inline">\(2\times3\)</span>. A <em>square matrix</em> has the same number of rows and columns.</p>
<p><span class="math display">\[
\mathbf{A} = \begin{bmatrix} 3 &amp; 5 &amp; 4 \\ 1 &amp; 1 &amp; 2 \\ 4 &amp; 1 &amp; 3 \end{bmatrix}
\]</span></p>
<p>We can access the shape of a matrix in numpy using its <code>shape</code> property.</p>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">4</span>], [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">3</span>]])</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(3, 3)</code></pre>
</div>
</div>
</section>
<section id="matrix-transpose" class="level2">
<h2 class="anchored" data-anchor-id="matrix-transpose">Matrix transpose</h2>
<p>The <strong>transpose</strong> of a matrix is an operation that swaps the rows and columns of the matrix. We denote the transpose of a matrix <span class="math inline">\(\mathbf{A}\)</span> as <span class="math inline">\(\mathbf{A}^T\)</span>.</p>
<p><span class="math display">\[
\mathbf{A} = \begin{bmatrix} A_{11} &amp; A_{12} &amp; A_{13} \\ A_{21} &amp; A_{22} &amp; A_{23} \end{bmatrix}, \quad \mathbf{A}^T = \begin{bmatrix} A_{11} &amp; A_{21} \\  A_{12} &amp; A_{22} \\  A_{13} &amp; A_{23} \end{bmatrix}
\]</span></p>
<p>In numpy we can transpose a matrix by using the <code>T</code> property.</p>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>]])</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>A.T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="300">
<pre><code>array([[1, 2],
       [1, 2],
       [1, 2]])</code></pre>
</div>
</div>
</section>
<section id="element-wise-matrix-operations" class="level2">
<h2 class="anchored" data-anchor-id="element-wise-matrix-operations">Element-wise matrix operations</h2>
<p>As with vectors, many operations on matrices are performed <em>element-wise</em>:</p>
<p><span class="math display">\[
\mathbf{A} + \mathbf{B} = \begin{bmatrix} A_{11} + B_{11}  &amp; A_{12} + B_{12} &amp; A_{13} + B_{13} \\ A_{21} + B_{21} &amp; A_{22} + B_{22} &amp; A_{23} + B_{23} \end{bmatrix}, \quad \log\mathbf{A} = \begin{bmatrix} \log A_{11}  &amp; \log A_{12} &amp; \log A_{13} \\ \log A_{21} &amp; \log A_{22} &amp; \log A_{23} \end{bmatrix}
\]</span></p>
<p>Scalar-matrix operation are also element-wise:</p>
<p><span class="math display">\[
c\mathbf{A} = \begin{bmatrix} cA_{11}  &amp; cA_{12} &amp; cA_{13} \\ cA_{21} &amp; cA_{22} &amp; cA_{23} \end{bmatrix}
\]</span></p>
<p>In numpy:</p>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> <span class="dv">5</span> <span class="op">*</span> A </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">+</span> B</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="301">
<pre><code>array([[ 6,  6,  6],
       [12, 12, 12]])</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Other element-wise operations
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>Unary operations</strong></p>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>np.sqrt(A)     <span class="co"># Take the square root of every element</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>np.log(A)      <span class="co"># Take the (natural) log of every element</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>np.exp(A)      <span class="co"># Take e^x for every element x in A</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>np.sin(A)      <span class="co"># Take sin(x) for every element x in A</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>np.cos(A)      <span class="co"># Take cos(x) for every element x in A</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="302">
<pre><code>array([[ 0.54030231,  0.54030231,  0.54030231],
       [-0.41614684, -0.41614684, -0.41614684]])</code></pre>
</div>
</div>
<p><strong>Scalar operations</strong></p>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">+</span> <span class="dv">2</span>          <span class="co"># Add a scalar to every element of A</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">-</span> <span class="dv">1</span>          <span class="co"># Subtract a scalar from every element of A</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>A <span class="op">*</span> <span class="dv">4</span>          <span class="co"># Multiply a scalar with every element of A</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>A <span class="op">/</span> <span class="dv">6</span>          <span class="co"># Divide every element by a scalar</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>A <span class="op">**</span> <span class="dv">3</span>         <span class="co"># Take every element to a power</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="303">
<pre><code>array([[1, 1, 1],
       [8, 8, 8]])</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="matrix-vector-products" class="level2">
<h2 class="anchored" data-anchor-id="matrix-vector-products">Matrix-vector products</h2>
<p>A matrix-vector product is an operation between a matrix and a vector that produces a new vector. Given a matrix <span class="math inline">\(\mathbf{A}\)</span> and a vector <span class="math inline">\(\mathbf{x}\)</span>, we write the matrix-vector product as:</p>
<p><span class="math display">\[
\mathbf{A}\mathbf{x} = \begin{bmatrix} A_{11} &amp; A_{12} &amp; A_{13} \\ A_{21} &amp; A_{22} &amp; A_{23} \\ A_{23} &amp; A_{32} &amp; A_{33} \end{bmatrix} \begin{bmatrix} x_1\\ x_2\\ x_3\end{bmatrix} = \begin{bmatrix} \sum_{i=1}^n x_i A_{1i} \\  \sum_{i=1}^n x_i A_{2i} \\  \sum_{i=1}^n x_i A_{3i} \end{bmatrix} = \begin{bmatrix} \mathbf{x}\cdot  \mathbf{A}_{1} \\ \mathbf{x}\cdot  \mathbf{A}_{2} \\ \mathbf{x} \cdot \mathbf{A}_{2} \end{bmatrix}
\]</span></p>
<p>In other words, each entry of the resulting vector is the dot product between <span class="math inline">\(\mathbf{x}\)</span> and a row of <span class="math inline">\(A\)</span>. In numpy we also use <code>np.dot</code> for matrix-vector products:</p>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">4</span>], [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">3</span>]])</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array([<span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">1</span>])</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>np.dot(A, x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="304">
<pre><code>array([35,  9, 16])</code></pre>
</div>
</div>
<p>We say that a square matrix <span class="math inline">\(A\)</span> defines a <em>linear mapping</em> from <span class="math inline">\(\mathbb{R}^n\rightarrow\mathbb{R}^n\)</span>, which simply means if we multiply any vector <span class="math inline">\(\mathbf{x}\in\mathbb{R}^n\)</span> by <span class="math inline">\(A\)</span> we get a new vector in <span class="math inline">\(\mathbb{R}^n\)</span> where the elements are a linear combination of the elements in <span class="math inline">\(\mathbf{x}\)</span>.</p>
<p>Geometrically the matrix <span class="math inline">\(A\)</span> defines a transformation that scales and rotates any vector <span class="math inline">\(\mathbf{x}\)</span> about the origin.</p>
<p>The number of columns of <span class="math inline">\(A\)</span> must match the size of the vector <span class="math inline">\(\mathbf{x}\)</span>, but if <span class="math inline">\(A\)</span> has a different number of rows, the output will simply have a different size.</p>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>np.dot(A[:<span class="dv">2</span>], x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="305">
<pre><code>array([35,  9])</code></pre>
</div>
</div>
<p>In general, an <span class="math inline">\(n\times m\)</span> matrix defines a linear mapping <span class="math inline">\(\mathbb{R}^n\rightarrow\mathbb{R}^m\)</span>, transforming <span class="math inline">\(\mathbf{x} \in \mathbb{R}^n\)</span> into a possibly higher or lower dimensional space <span class="math inline">\(\mathbb{R}^m\)</span>.</p>
</section>
<section id="matrix-multiplication" class="level2">
<h2 class="anchored" data-anchor-id="matrix-multiplication">Matrix multiplication</h2>
<p><strong>Matrix multiplication</strong> is a fundamental operation between two matrices. It is defined as:</p>
<p><span class="math display">\[
\mathbf{A}\mathbf{B}  = \begin{bmatrix} A_{11} &amp; A_{12} &amp; A_{13} \\ A_{21} &amp; A_{22} &amp; A_{23} \\ A_{23} &amp; A_{32} &amp; A_{33} \end{bmatrix} \begin{bmatrix} B_{11} &amp; B_{12} \\ B_{21} &amp; B_{22} \\ B_{31} &amp; B_{32} \end{bmatrix}  =\begin{bmatrix} \sum_{i=1}^n A_{1i} B_{i1} &amp; \sum_{i=1}^n A_{i1}B_{i2} \\  \sum_{i=1}^n A_{2i}B_{i1} &amp; \sum_{i=1}^n A_{2i}B_{i2}  \\  \sum_{i=1}^n A_{3i}B_{i1} &amp; \sum_{i=1}^n A_{3i}B_{i2} \end{bmatrix} = \begin{bmatrix} \mathbf{A}_{1} \cdot \mathbf{B}_{*1} &amp; \mathbf{A}_{1} \cdot \mathbf{B}_{*2} \\ \mathbf{A}_{2} \cdot \mathbf{B}_{*1} &amp; \mathbf{A}_{2} \cdot \mathbf{B}_{*2}  \\ \mathbf{A}_{1} \cdot \mathbf{B}_{*1} &amp; \mathbf{A}_{1} \cdot \mathbf{B}_{*2}  \end{bmatrix}
\]</span></p>
<p>This means that if we multiply an <span class="math inline">\(n\times m\)</span> matrix <span class="math inline">\(\mathbf{A}\)</span> with an <span class="math inline">\(m\times k\)</span> matrix <span class="math inline">\(\mathbf{B}\)</span> we get an <span class="math inline">\(n\times k\)</span> matrix <span class="math inline">\(\mathbf{C}\)</span>, such that <span class="math inline">\(\mathbf{C}_{ij}\)</span> is the dot product of the <span class="math inline">\(i\)</span>-th row of <span class="math inline">\(\mathbf{A}\)</span> with the <span class="math inline">\(j\)</span>-th row of <span class="math inline">\(\mathbf{B}\)</span>.</p>
<p>In numpy we once again use the <code>np.dot</code> function to perform matrix-multiplications.</p>
<div class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> np.array([[<span class="dv">2</span>, <span class="op">-</span><span class="dv">1</span>], [<span class="dv">3</span>, <span class="dv">1</span>], [<span class="op">-</span><span class="dv">2</span>, <span class="dv">5</span>]])</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>C <span class="op">=</span> np.dot(A, B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that the number of rows of <span class="math inline">\(\mathbf{A}\)</span> must match the number of columns of <span class="math inline">\(\mathbf{B}\)</span> for the matrix multiplication <span class="math inline">\(\mathbf{A}\mathbf{B}\)</span> to be defined. This implies that matrix multiplication is <em>non-communitive:</em></p>
<p><span class="math display">\[
\mathbf{A}\mathbf{B}\neq \mathbf{B}\mathbf{A}
\]</span></p>
<p>However matrix multiplication is <em>associative</em> and <em>distributive</em>:</p>
<p><span class="math display">\[
\mathbf{A}(\mathbf{B}\mathbf{C})=(\mathbf{A}\mathbf{B})\mathbf{C}, \quad \mathbf{A}(\mathbf{B} +\mathbf{C}) = \mathbf{A}\mathbf{B} + \mathbf{A}\mathbf{C}
\]</span></p>
<p>We can see matrix multiplication as a <em>composition</em> of linear maps, meaning that if we take the product <span class="math inline">\(\mathbf{A}\mathbf{B}\)</span> and apply the resulting matrix to a vector <span class="math inline">\(\mathbf{x}\)</span>, it is equivalent to first transforming <span class="math inline">\(\mathbf{x}\)</span> with <span class="math inline">\(\mathbf{B}\)</span> and then with <span class="math inline">\(\mathbf{A}\)</span>. We can state this succinctly as:</p>
<p><span class="math display">\[
(\mathbf{A}\mathbf{B})\mathbf{x} = \mathbf{A}(\mathbf{B}\mathbf{x})
\]</span></p>
<p>We can see this in numpy:</p>
<div class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">3</span>])</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>np.dot(np.dot(A, B), x), np.dot(A, np.dot(B, x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="307">
<pre><code>(array([79, 31, 41]), array([79, 31, 41]))</code></pre>
</div>
</div>
</section>
<section id="vector-notation" class="level2">
<h2 class="anchored" data-anchor-id="vector-notation">Vector notation</h2>
<p>As we’ve seen a vector is a 1-dimensional set of numbers. For example, we can write the vector <span class="math inline">\(\mathbf{x} \in \mathbb{R}^3\)</span> as:</p>
<p><span class="math display">\[\mathbf{x} = \begin{bmatrix} x_1 \\ x_2 \\ x_3 \end{bmatrix}\]</span></p>
<p>A vector can also be seen as either an <span class="math inline">\(n \times 1\)</span> matrix (column vector) or a <span class="math inline">\(1 \times n\)</span> matrix (row vector).</p>
<p><span class="math display">\[\text{Column vector: } \mathbf{x} = \begin{bmatrix}
x_1 \\
x_2 \\
x_3
\end{bmatrix}, \quad \text{Row vector: } \mathbf{x} = \begin{bmatrix}
x_1 &amp; x_2 &amp; x_3
\end{bmatrix}\]</span></p>
<p>Note that we <em>may</em> use the same notation for both as they refer to the same concept (a vector).</p>
<p>The difference between row and column vectors becomes relevant when we consider matrix-vector multiplication. We can write matrix-vector multiplication in two ways: <span class="math display">\[\text{Matrix-vector: }\mathbf{A}\mathbf{x} = \mathbf{b}, \quad \text{Vector-matrix: }\mathbf{x}\mathbf{A}^T= \mathbf{b}\]</span> In <em>matrix-vector multiplication</em> we treat <span class="math inline">\(\textbf{x}\)</span> as a column vector (<span class="math inline">\(n \times 1\)</span> matrix), while in <em>vector-matrix multiplication</em> we treat it as a row vector (<span class="math inline">\(n \times 1\)</span> matrix). Transposing <span class="math inline">\(A\)</span> for left multiplication ensures that the two forms give the same answer.</p>
<p>In Numpy the <code>np.dot</code> function works in this way. Given a matrix <code>A</code> and a 1-dimensional vector <code>x</code>, performing both operations will give the same result (another 1-dimensional vector):</p>
<div class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[ <span class="dv">1</span>,  <span class="dv">2</span>, <span class="op">-</span><span class="dv">1</span>],</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>              [ <span class="dv">5</span>, <span class="op">-</span><span class="dv">3</span>,  <span class="dv">2</span>],</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>              [<span class="op">-</span><span class="dv">2</span>,  <span class="dv">1</span>, <span class="op">-</span><span class="dv">4</span>],</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>             ])</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>])</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>Ax   <span class="op">=</span> np.dot(A, x)</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>xA_T <span class="op">=</span> np.dot(x, A.T)</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Ax   = '</span>, Ax)</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'xA^T = '</span>, xA_T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Ax   =  [-4 13 -8]
xA^T =  [-4 13 -8]</code></pre>
</div>
</div>
</section>
<section id="vector-notation-revisited" class="level2">
<h2 class="anchored" data-anchor-id="vector-notation-revisited">Vector notation revisited</h2>
<p>It often is much simpler to explicitly define vectors as being either row or column vectors. The common convention in machine learning is to assume that all vectors are column vectors (<span class="math inline">\(n \times 1\)</span> matricies) and thus a row vector ( <span class="math inline">\(1\times n\)</span> matrix) is obtained by explicit transposition:</p>
<p><span class="math display">\[\text{Column vector: } \mathbf{x} = \begin{bmatrix}
x_1 \\
x_2 \\
x_3
\end{bmatrix}, \quad \text{Row vector: } \mathbf{x}^T = \begin{bmatrix}
x_1 &amp; x_2 &amp; x_3
\end{bmatrix}\]</span></p>
<p>In this case, we would rewrite the matrix-vector and vector-matrix products we saw above as:</p>
<p><span class="math display">\[\text{Matrix-vector: }\mathbf{A}\mathbf{x} = \mathbf{b}, \quad \text{Vector-matrix: }\mathbf{x}^T\mathbf{A}^T= \mathbf{b}^T\]</span></p>
<p>In Numpy, we can make a vector into an explicit column or row vector by inserting a new dimension, either with the <code>np.expand_dims</code> function or with the indexing operator:</p>
<div class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>row_x <span class="op">=</span> np.expand_dims(x, axis<span class="op">=</span><span class="dv">0</span>) <span class="co"># Add a new leading dimension to x</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>row_x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="309">
<pre><code>array([[ 1, -2,  1]])</code></pre>
</div>
</div>
<div class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>column_x <span class="op">=</span> np.expand_dims(x, axis<span class="op">=</span><span class="dv">1</span>) <span class="co"># Add a new second dimension to x</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="cf">assert</span> np.<span class="bu">all</span>(column_x.T <span class="op">==</span> row_x)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>column_x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="310">
<pre><code>array([[ 1],
       [-2],
       [ 1]])</code></pre>
</div>
</div>
<p>Alternatively:</p>
<div class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>row_x <span class="op">=</span> x[<span class="va">None</span>, :]</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>column_x <span class="op">=</span> x[:, <span class="va">None</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="element-wise-multiplication" class="level2">
<h2 class="anchored" data-anchor-id="element-wise-multiplication">Element-wise multiplication</h2>
<p>It is important to note that in numpy the <code>*</code> operator does <strong>not</strong> perform matrix multiplication, instead it performs element-wise multiplication for both matrices and vectors.</p>
<div class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">2</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">3</span>]])</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>B <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">1</span>, <span class="dv">2</span>]])</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>A <span class="op">*</span> B</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="312">
<pre><code>array([[1, 2],
       [2, 4],
       [3, 6]])</code></pre>
</div>
</div>
<p>In mathematical notation we will denote element-wise multiplication as:</p>
<p><span class="math display">\[
\mathbf{A} \odot \mathbf{B} = \begin{bmatrix} A_{11} B_{11}  &amp; A_{12}  B_{12} &amp; A_{13}  B_{13} \\ A_{21}  B_{21} &amp; A_{22}  B_{22} &amp; A_{23}  B_{23} \end{bmatrix}
\]</span></p>
</section>
<section id="matrix-reductions" class="level2">
<h2 class="anchored" data-anchor-id="matrix-reductions">Matrix reductions</h2>
<p>As we saw with vectors, we can take the <strong>sum</strong> of the elements of a matrix using the <code>np.sum</code> function:</p>
<div class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">sum</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="313">
<pre><code>12</code></pre>
</div>
</div>
<p>The result is a scalar of the form:</p>
<p><span class="math display">\[
\text{sum}(\mathbf{A}) = \sum_{i=1}^n\sum_{j=1}^m A_{ij}
\]</span></p>
<p>In many cases we may wish to take the sum <em>along an axis</em> of a matrix. This operation results in a vector where each entry is the sum of elements from the corresponding row or column of the matrix.</p>
<p><span class="math display">\[
\text{rowsum}(\mathbf{A}) = \begin{bmatrix} \sum_{i=1}^n A_{i1} \\ \sum_{i=1}^n A_{i2} \\ \sum_{i=1}^n A_{i3} \\ \vdots\end{bmatrix}, \quad \text{colsum}(\mathbf{A}) = \begin{bmatrix} \sum_{j=1}^m A_{1j} \\ \sum_{j=1}^m A_{2j} \\ \sum_{j=1}^m A_{3j} \\ \vdots\end{bmatrix}
\]</span></p>
<p>In numpy we can specify a sum along an axis by providing an <code>axis</code> argument to <code>np.sum</code>. Setting <code>axis=0</code> specifies a row-sum, while <code>axis=1</code> specifies a column sum.</p>
<div class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">2</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">3</span>]])</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>np.<span class="bu">sum</span>(A, axis<span class="op">=</span><span class="dv">0</span>), np.<span class="bu">sum</span>(A, axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1 1]
 [2 2]
 [3 3]]</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="314">
<pre><code>(array([6, 6]), array([2, 4, 6]))</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Other matrix reduction examples
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.mean(A))            <span class="co"># Take the mean of all elements in x</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.std(A, axis<span class="op">=</span><span class="dv">0</span>))     <span class="co"># Take the standard deviation of each column of x</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.<span class="bu">min</span>(A, axis<span class="op">=</span><span class="dv">1</span>))     <span class="co"># Find the minimum element in each row of x</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.<span class="bu">max</span>(A))             <span class="co"># Find the maximum element in x</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2.0
[0.81649658 0.81649658]
[1 2 3]
3</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="identity-matrices" class="level2">
<h2 class="anchored" data-anchor-id="identity-matrices">Identity Matrices</h2>
<p>The identity matrix, denoted at <span class="math inline">\(\mathbf{I}\)</span> is a special type of square matrix. It is defined as the matrix with <span class="math inline">\(1\)</span> for every diagonal element (<span class="math inline">\(\mathbf{I}_{i=j}=1\)</span>) and <span class="math inline">\(0\)</span> for every other element (<span class="math inline">\(\mathbf{I}_{i\neq j}=0\)</span>). A <span class="math inline">\(3\times 3\)</span> identity matrix looks like:</p>
<p><span class="math display">\[\mathbf{I} = \begin{bmatrix}1 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1\end{bmatrix}\]</span></p>
<p>The identify matrix has the unique property that any appropriately sized matrix (or vector) multiplied with <span class="math inline">\(\mathbf{I}\)</span> will equal itself:</p>
<p><span class="math display">\[
\mathbf{I}\mathbf{A} = \mathbf{A}
\]</span></p>
<p>If we think of matrices as linear mappings the <em>identity</em> matrix simply maps any vector to itself.</p>
<p><span class="math display">\[
\mathbf{I} \mathbf{x} = \mathbf{x}
\]</span></p>
<p>In numpy we can create an identity matrix using the <code>np.eye</code> function:</p>
<div class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>I <span class="op">=</span> np.eye(<span class="dv">3</span>) <span class="co"># Create a 3x3 identity matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="solving-systems-of-linear-equations" class="level2">
<h2 class="anchored" data-anchor-id="solving-systems-of-linear-equations">Solving systems of linear equations</h2>
<p>Consider the matrix-vector product between a matrix <span class="math inline">\(\mathbf{A}\)</span> and a vector <span class="math inline">\(\mathbf{x}\)</span>, we can denote the result of this multiplication as <span class="math inline">\(\mathbf{b}\)</span>:</p>
<p><span class="math display">\[
\mathbf{A}\mathbf{x} =\mathbf{b}
\]</span></p>
<p>In many common cases we will know the matrix <span class="math inline">\(\mathbf{A}\)</span> and the vector <span class="math inline">\(\mathbf{b}\)</span>, but <em>not</em> the vector <span class="math inline">\(\mathbf{x}\)</span>. In such cases we need to <em>solve</em> this equation for <span class="math inline">\(\mathbf{x}\)</span>:</p>
<p><span class="math display">\[
\begin{bmatrix} A_{11} &amp; A_{12} &amp; A_{13} \\ A_{21} &amp; A_{22} &amp; A_{23} \\ A_{23} &amp; A_{32} &amp; A_{33} \end{bmatrix} \begin{bmatrix} \textbf{?}\\ \textbf{?}\\ \textbf{?}\end{bmatrix} = \begin{bmatrix} b_1 \\  b_2 \\  b_3 \end{bmatrix}
\]</span></p>
<p>We call this <em>solving a system of linear equations</em>. A common algorithm used to find <span class="math inline">\(\mathbf{x}\)</span> is <em>Gaussian elimination</em>, the details of which are outside the scope of this course. Luckily, numpy gives us a convenient function for solving this problem: <code>np.linalg.solve</code>.</p>
<div class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">3</span>, <span class="dv">1</span>], [<span class="op">-</span><span class="dv">1</span>, <span class="dv">4</span>]])</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array([<span class="op">-</span><span class="dv">2</span>, <span class="dv">1</span>])</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linalg.solve(A, b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that in some cases there may not be any <span class="math inline">\(\mathbf{x}\)</span> that satisfies the equation (or there may be infinitely many). The conditions for this are beyond the scope of this course.</p>
</section>
<section id="inverse-matrices" class="level2">
<h2 class="anchored" data-anchor-id="inverse-matrices">Inverse matrices</h2>
<p>The <em>inverse</em> of a square matrix is denoted by <span class="math inline">\(\mathbf{A}^{-1}\)</span> and is defined as the matrix such that:</p>
<p><span class="math display">\[
\mathbf{A}\mathbf{A}^{-1} = \mathbf{I}
\]</span></p>
<p>This corresponds to the <em>inverse</em> of the linear map defined by <span class="math inline">\(\mathbf{A}\)</span>. Any vector transformed by <span class="math inline">\(\mathbf{A}\)</span> can be transformed back by applying the inverse matrix:</p>
<p><span class="math display">\[
\mathbf{A}^{-1}\left(\mathbf{A}\mathbf{x}\right) =\mathbf{x}
\]</span></p>
<p>We can also write the solution to a system of linear equations in terms of the inverse, by multiplying both sides by <span class="math inline">\(\mathbf{A}^{-1}\)</span>:</p>
<p><span class="math display">\[
\mathbf{A}\mathbf{x}=\mathbf{b}\quad \longrightarrow \quad \mathbf{A}^{-1}(\mathbf{A}\mathbf{x})=\mathbf{A}^{-1}\mathbf{b} \quad \longrightarrow \quad \mathbf{x}=\mathbf{A}^{-1}\mathbf{b}
\]</span></p>
<p>In numpy we can find the inverse of a matrix using the <code>np.linalg.inv</code> function:</p>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>A_inv <span class="op">=</span> np.linalg.inv(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that not every matrix has an inverse! Again, we won’t worry about these cases for now.</p>
</section>
</section>
<section id="calculus-prerequisites" class="level1">
<h1>Calculus prerequisites</h1>
<p>In addition to linear algebra, we will need a number of fundamental concepts from calculus throughout this course. We will review them here.</p>
<section id="functions" class="level2">
<h2 class="anchored" data-anchor-id="functions">Functions</h2>
<p>A <strong>function</strong> is a general mapping from one set to another.</p>
<p><span class="math display">\[
y=f(x),\quad f:\mathbb{R}\rightarrow\mathbb{R}
\]</span></p>
<p>In this course will focus on functions of <em>real</em> <em>numbers,</em> that is, mappings from real numbers to other real numbers this is denoted using the notation <span class="math inline">\(\mathbb{R}\rightarrow\mathbb{R}\)</span> above. We call the set of possible inputs the <em>domain</em> of the function (in this case real numbers) and the corresponding set of possible outputs the <em>codomain</em> or <em>range</em> of the function. In the notation above <span class="math inline">\(x\)</span> is the real valued <em>input</em> and <span class="math inline">\(y\)</span> is the real-valued <em>output</em>.</p>
<p>We can definite functions as compositions of simple operations. For example we could define a polynomial function as:</p>
<p><span class="math display">\[
f(x) = x^2 + 3x + 1
\]</span></p>
<p>In code we can implement functions as, well, functions:</p>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> x <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>f(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="319">
<pre><code>41</code></pre>
</div>
</div>
</section>
<section id="derivatives" class="level2">
<h2 class="anchored" data-anchor-id="derivatives">Derivatives</h2>
<p>The <strong>derivative</strong> of a function at input <span class="math inline">\(x\)</span> defines how the function’s output changes as the input changes from <span class="math inline">\(x\)</span>. It is equivalent to the <em>slope</em> of the line tangent to the function at the input <span class="math inline">\(x\)</span>. We’ll use the notation <span class="math inline">\(\frac{df}{dx}\)</span> to denote the <em>derivative</em> of the function <span class="math inline">\(f\)</span> at input <span class="math inline">\(x\)</span>. Formally:</p>
<p><span class="math display">\[
\frac{df}{dx} = \underset{\epsilon\rightarrow0}{\lim} \frac{f(x+\epsilon) - f(x)}{\epsilon}
\]</span></p>
<p>Intunitively, this means if we change our input <span class="math inline">\(x\)</span> by some small amount <span class="math inline">\(\epsilon\)</span>, the output of our function will change by approximately <span class="math inline">\(\frac{df}{dx}\epsilon\)</span></p>
<p><span class="math display">\[
f(x+\epsilon) \approx f(x)+\frac{df}{dx}\epsilon
\]</span></p>
<p>Note that with respect to <span class="math inline">\(\epsilon\)</span> this approximation is a line with slope <span class="math inline">\(\frac{df}{dx}\)</span> and intercept <span class="math inline">\(f(x)\)</span>, therefore we say that this is a <em>linear approximation</em> to the function <span class="math inline">\(f\)</span> at input <span class="math inline">\(x\)</span>.</p>
<p>We can also use the notation <span class="math inline">\(\frac{d}{dx}\)</span> to denote the <em>derivative operator</em>. This means “find the derivative of the following expression with respect to <span class="math inline">\(x\)</span>”.</p>
<p><span class="math display">\[
\frac{d}{dx}f(x) = \frac{df}{dx}
\]</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Caveat
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This definition assumes that the limit exists at the input <span class="math inline">\(x\)</span>, which is not always true. We will see practical examples later in the course where this assumption does not hold.</p>
</div>
</div>
</div>
</section>
<section id="derivative-functions" class="level2">
<h2 class="anchored" data-anchor-id="derivative-functions">Derivative functions</h2>
<p>We can also talk about the function that maps any input <span class="math inline">\(x\)</span> to the derivative <span class="math inline">\(\frac{df}{dx}\)</span> we call this the <em>derivative function</em> and denote it as <span class="math inline">\(f'(x)\)</span>. So:</p>
<p><span class="math display">\[
\frac{df}{dx}=f'(x)
\]</span></p>
<p>Given a function defined as a composition of basic operations, we can use a set of standard rules to find the corresponding derivative function. For example using the rules <span class="math inline">\(\frac{d}{dx}x^a=ax\)</span> , <span class="math inline">\(\frac{d}{dx}ax=a\)</span> and <span class="math inline">\(\frac{d}{dx}a=0\)</span>, we can derive the derivative function for the polynomial above:</p>
<p><span class="math display">\[
f(x) = x^2 + 3x + 1
\]</span></p>
<p><span class="math display">\[
f'(x) = 2x + 3
\]</span></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Basic derivative rules
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<table class="table">
<thead>
<tr class="header">
<th>Operation</th>
<th>Derivative <span class="math inline">\(\frac{d}{dx}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(a\)</span></td>
<td><span class="math inline">\(0\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(ax\)</span></td>
<td><span class="math inline">\(a\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(x^a\)</span></td>
<td><span class="math inline">\(ax\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\log(x)\)</span></td>
<td><span class="math inline">\(\frac{1}{x}\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(e^x\)</span></td>
<td><span class="math inline">\(e^x\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(f(x) + g(x)\)</span></td>
<td><span class="math inline">\(f'(x)+g'(x)\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(f(x)g(x)\)</span></td>
<td><span class="math inline">\(f'(x)g(x) + f(x)g'(x)\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\frac{f(x)}{g(x)}\)</span></td>
<td><span class="math inline">\(\frac{f'(x)g(x)-f(x)g'(x)}{g(x)^2}\)</span></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="chain-rule" class="level2">
<h2 class="anchored" data-anchor-id="chain-rule">Chain rule</h2>
<p><em>Composing</em> two functions means to apply one function to the output of another, for example we could apply <span class="math inline">\(f\)</span> to the output of <span class="math inline">\(g\)</span>:</p>
<p><span class="math display">\[
y = f\big(g\left(x\right)\big)
\]</span></p>
<p>This is easily replicated in code:</p>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> x <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> g(x):</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">5</span> <span class="op">*</span> x <span class="op">-</span> <span class="dv">2</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>f(g(<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="320">
<pre><code>209</code></pre>
</div>
</div>
<p>The <strong>chain</strong> <strong>rule</strong> tells us how to find the derivative of a composition of functions like this. We can write the rule either in terms of derivatives or derivative functions</p>
<p><span class="math display">\[
\frac{d}{dx}f\big(g\left(x\right)\big) = \frac{df}{dg}\frac{dg}{dx} \quad \text{or} \quad \frac{d}{dx}f\big(g\left(x\right)\big) =  f'\big(g\left(x\right)\big)g'\left(x\right)
\]</span></p>
<p>Note that in our derivative notation we’re using <span class="math inline">\(f\)</span> and <span class="math inline">\(g\)</span> to denote the outputs of the respective functions.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Derivatives in code
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>A natural question to ask at this point is: <em>does the derivative operator exist in Python or numpy?</em>. The answer is amazingly: <strong>yes!</strong> However implementing such an operator is nontrivial. In fact, a significant portion of this course will be devoted to exploring how to implement exactly such an operation for numpy. As a preview, we will end up with the ability to take derivatives as follows:</p>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> x <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>fx <span class="op">=</span> f(<span class="dv">5</span>)</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>df_dx <span class="op">=</span> derivative(f)(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="partial-derivatives" class="level2">
<h2 class="anchored" data-anchor-id="partial-derivatives">Partial derivatives</h2>
<p>A function does not need to be restricted to having a single input. We can specify a function with multiple inputs as follows:</p>
<p><span class="math display">\[
f(x, y, z) = x^2 + 3xy - \log(z)
\]</span></p>
<p>In code this would look like;</p>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x, y, z):</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> y <span class="op">+</span> np.log(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>A <strong>partial derivative</strong> is the derivative of a multiple-input function with respect to a single input, <em>assuming all other inputs are constant</em>. We will explore the implications of that condition later on in this course. For now, we will simply view partial derivatives as a straightforward extension of derivatives, using the modified notation <span class="math inline">\(\frac{\partial}{\partial x}\)</span>.</p>
<p>More formally, we can define the partial derivative with respect to each input of a function as:</p>
<p><span class="math display">\[
\frac{\partial f}{\partial x} = \underset{\epsilon\rightarrow0}{\lim} \frac{f(x+\epsilon, y, z) - f(x,y,z)}{\epsilon}, \quad \frac{\partial f}{\partial y} = \underset{\epsilon\rightarrow0}{\lim} \frac{f(x, y+\epsilon, z) - f(x,y,z)}{\epsilon}
\]</span></p>
<p>These partial derivatives tell us how the output of the function changes as we change each of the inputs individually.</p>
</section>
<section id="partial-derivative-functions" class="level2">
<h2 class="anchored" data-anchor-id="partial-derivative-functions">Partial derivative functions</h2>
<p>We can also specify partial derivative functions in the same way as derivative functions. We’ll use subscript notation to specify which input we are differentiating with respect to.</p>
<p><span class="math display">\[
\frac{\partial f}{\partial x} = f_x'(x, y, z)
\]</span></p>
<p>We can derive partial derivative functions using the same set of derivative rules:</p>
<p><span class="math display">\[
f(x, y, z) = x^2 + 3xy - \log(z)
\]</span></p>
<p><span class="math display">\[
f_x'(x, y, z) = 2x + 3y
\]</span></p>
<p><span class="math display">\[
f_y'(x, y, z) = 3x
\]</span></p>
<p><span class="math display">\[
f_z'(x, y, z) = -\frac{1}{z}
\]</span></p>
</section>
<section id="functions-of-vectors" class="level2">
<h2 class="anchored" data-anchor-id="functions-of-vectors">Functions of vectors</h2>
<p>We can also define functions that take vectors (or matrices) as inputs.</p>
<p><span class="math display">\[
y = f(\mathbf{x}) \quad f: \mathbb{R}^n \rightarrow \mathbb{R}
\]</span></p>
<p>Here <span class="math inline">\(f\)</span> is a mapping from length <span class="math inline">\(n\)</span> vectors to real numbers. As a concrete example we could define the function:</p>
<p><span class="math display">\[
f(\mathbf{x}) = \sum_{i=1}^n x_i^3 + 1
\]</span></p>
<p>Here’s the same function in numpy:</p>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.<span class="bu">sum</span>(x <span class="op">**</span> <span class="dv">3</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>f(np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="322">
<pre><code>37</code></pre>
</div>
</div>
<p>Note that functions of vectors are equivalent to multiple-input functions, but with a more compact notation!</p>
<p><span class="math display">\[f(\mathbf{x}) \equiv f(x_1, x_2, x_3...)\]</span></p>
</section>
<section id="partial-derivatives-of-vectors" class="level2">
<h2 class="anchored" data-anchor-id="partial-derivatives-of-vectors">Partial derivatives of vectors</h2>
<p>We can take partial derivates of vector functions simply by recognizing that the input vector is a set of variables and applying the standard set of derivative rules.</p>
<p>For example, given a vector <span class="math inline">\(\mathbf{x}\in \mathbb{R}^3\)</span>: <span class="math display">\[\mathbf{x} = \begin{bmatrix}x_1 \\ x_2\\ x_3 \end{bmatrix}\]</span> We can find the partial derivative of the dot-product of <span class="math inline">\(\mathbf{x}\)</span> with itself with respect to a single entry: <span class="math inline">\(x_1\)</span>: <span class="math display">\[\frac{\partial }{\partial x_1} \mathbf{x}^T\mathbf{x}=\]</span> <span class="math display">\[\frac{\partial }{\partial x_1} \sum_{i=1}^n x_i x_i = \frac{\partial }{\partial x_1}(x_1^2 + x_2^2+x_3^2)\]</span> We see that the terms <span class="math inline">\(x_2^2\)</span> an <span class="math inline">\(x_3^2\)</span> do not depend on <span class="math inline">\(x_1\)</span>, therefore the derivative is <span class="math inline">\(0\)</span> and the final result is: <span class="math display">\[=\frac{\partial }{\partial x_1} x_1^2 = 2 x_1\]</span></p>
<p>In general, the addition rule applies to summations, so: <span class="math display">\[\frac{\partial }{\partial x}\sum f(x) = \sum \frac{\partial }{\partial x} f(x)\]</span></p>
<p>Other derivative rules also apply. For example, the chain rule works as normal: <span class="math display">\[\frac{\partial }{\partial x_1} f(\mathbf{x}^T\mathbf{x})=\]</span> <span class="math display">\[f'(\mathbf{x}^T\mathbf{x}) \frac{\partial }{\partial x_1} \mathbf{x}^T\mathbf{x} = f'(\mathbf{x}^T\mathbf{x}) (2x_1)\]</span></p>
</section>
<section id="gradients" class="level2">
<h2 class="anchored" data-anchor-id="gradients">Gradients</h2>
<p>The <strong>gradient</strong> of a vector-input function is a vector such that each element is the partial derivative of the function with respect to the corresponding element of the input vector. We’ll use the same notation as derivatives for gradients.</p>
<p><span class="math display">\[
\frac{df}{d\mathbf{x}} = \begin{bmatrix} \frac{\partial f}{\partial x_1} \\ \frac{\partial f}{\partial x_2} \\ \frac{\partial f}{\partial x_3} \\ \vdots \end{bmatrix}
\]</span></p>
<p>The gradient is a vector that <em>tangent</em> to the function <span class="math inline">\(f\)</span> at the input <span class="math inline">\(\mathbf{x}\)</span>. Just as with derivatives, this means that the gradient defines a <em>linear</em> <em>approximation</em> to the function at the point <span class="math inline">\(\mathbf{x}\)</span>.</p>
<p><span class="math display">\[
f(\mathbf{x}+\mathbf{\epsilon}) \approx f(\mathbf{x}) + \frac{df}{d\mathbf{x}} \cdot \mathbf{\epsilon}
\]</span></p>
<p>Where <span class="math inline">\(\mathbf{\epsilon}\)</span> is now a small vector. Intuitively, this means that if we take a small step <em>in any direction</em> as defined by <span class="math inline">\(\mathbf{\epsilon}\)</span>, the gradient will approximate the change in the output of the function. Becuase we are now in more than 1 dimension, this approximation defines a <em>plane</em> in <span class="math inline">\(\mathbb{R}^n\)</span>.</p>
<p>Another extremely important property of the gradient is that it points in the direction of maximum change in the function. Meaning that if we were to take an infinitesimal step <span class="math inline">\(\mathbf{\epsilon}\)</span> from <span class="math inline">\(\mathbf{x}\)</span> in any direction, stepping in the gradient direction would give use the maximum value of <span class="math inline">\(f(\mathbf{x} +\mathbf{\epsilon})\)</span>. We can see this from the approximation above: <span class="math inline">\(f(\mathbf{x} +\mathbf{\epsilon})\)</span> is maximized when <span class="math inline">\(\frac{df}{d\mathbf{x}}\)</span> and <span class="math inline">\(\mathbf{\epsilon}\)</span> are colinear.</p>
<p>We can define the gradient in this sense this more formally as:</p>
<p><span class="math display">\[
\frac{df}{d\mathbf{x}}= \underset{\gamma \rightarrow 0}{\lim}\ \underset{\|\mathbf{\epsilon}\|_2 &lt; \gamma}{\max} \frac{f(\mathbf{x} + \mathbf{\epsilon}) - f(\mathbf{x})}{\|\mathbf{\epsilon}\|_2}
\]</span></p>
</section>
<section id="gradient-functions" class="level2">
<h2 class="anchored" data-anchor-id="gradient-functions">Gradient functions</h2>
<p>Just as with derivatives and partial derivatives, we can define a <strong>gradient function</strong> that maps an input vector <span class="math inline">\(\mathbf{x}\)</span> to the gradient of the function <span class="math inline">\(f\)</span> at <span class="math inline">\(\mathbf{x}\)</span> as:</p>
<p><span class="math display">\[
\frac{df}{d\mathbf{x}}=\nabla f(\mathbf{x})
\]</span></p>
<p>Here <span class="math inline">\(\nabla f\)</span> is the gradient function for <span class="math inline">\(f\)</span>. If the function takes multiple vectors as input, we can specify the gradient function with respect to a particular input using subscript notation:</p>
<p><span class="math display">\[
\frac{df}{d\mathbf{x}}= \nabla_{\mathbf{x}} f(\mathbf{x}, \mathbf{y}), \quad \frac{df}{d\mathbf{y}}= \nabla_{\mathbf{y}} f(\mathbf{x}, \mathbf{y})
\]</span></p>
<p>Note that the gradient function is a mapping from <span class="math inline">\(\mathbb{R}^n\rightarrow\mathbb{R}^n\)</span>, meaning that it returns a vector with the same size as the input.</p>
</section>
</section>
<section id="visualization-with-numpy-and-matplotlib" class="level1">
<h1>Visualization with NumPy and Matplotlib</h1>
<p>Throughout this course it will be extremely important to be able to <em>visualize</em> the data and functions that we are working with. This section will give a quick introduction to the Python visualization tools we will be using.</p>
<p><a href="http://matplotlib.org/">MatPlotLib</a> is a library for generating plots and figures in Python, specifically modeled to mimic the capabilities of Matlab for generating easy visualizations. There are many alternative libraries for plotting data, some with featurs that matplotlib lacks, but MatPlotLib’s simplicity and similarity to Matlab syntax and capabilities have made it fairly popular.</p>
<section id="getting-started" class="level2">
<h2 class="anchored" data-anchor-id="getting-started">Getting started</h2>
<p>The standard way to import MatPlotLib is:</p>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The standard approach to interacting with MatPlotLib can take some getting used to. In MatPlotLib the current plot that we’re working on is part of the <em>global state</em>, meaning that we don’t create an explicit plot object, we simply call functions of <code>plt</code> to update what the current plot will look like.</p>
<p>When working in Jupyter notebooks, the current plot is displayed at the end of the current cell when it is run.</p>
</section>
<section id="scatterplots-and-line-plots" class="level2">
<h2 class="anchored" data-anchor-id="scatterplots-and-line-plots">Scatterplots and line plots</h2>
<p>The most typical action is to plot one sequence (x-values) against another (y-values); this can be done using disconnected points (a scatterplot), or by connecting adjacent points in the sequence (in the order they were provided). The latter is usually used to give a nice (piecewise linear) visualization of a continuous curve, by specifying x-values in order, and the y-values given by the function at those x-values.</p>
<p><strong>Plotting</strong> a scatter of data points:</p>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>x_values <span class="op">=</span> np.random.rand(<span class="dv">1</span>,<span class="dv">10</span>)   <span class="co"># unformly in [0,1)</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>y_values <span class="op">=</span> np.random.randn(<span class="dv">1</span>,<span class="dv">10</span>)  <span class="co"># Gaussian distribution</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>plt.plot(x_values, y_values, <span class="st">'ko'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="notes_files/figure-html/cell-62-output-1.png" width="582" height="411"></p>
</div>
</div>
<p>The string determines the plot appearance -- in this case, black circles. You can use color strings (‘r’, ‘g’, ‘b’, ‘m’, ‘c’, ‘y’, ...) or use the “Color” keyword to specify an RGB color. Marker appearance (‘o’,‘s’,‘v’,‘.’, ...) controls how the points look.</p>
<p>If we connect those points using a line appearance specification (‘-’,‘--’,‘:’,...), it will not look very good, because the points are not ordered in any meaningful way. Let’s try a line plot using an ordered sequence of x values:</p>
<div class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>x_values <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">8</span>,<span class="dv">100</span>)</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>y_values <span class="op">=</span> np.sin(x_values)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>plt.plot(x_values,y_values,<span class="st">'b'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="notes_files/figure-html/cell-63-output-1.png" width="590" height="411"></p>
</div>
</div>
<p>This is actually a plot of a large number of points (100), with no marker shape and connected by a solid line.</p>
<p>For plotting multiple point sets or curves, you can pass more vectors into the plot function, or call the function multiple times:</p>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>x_values <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">8</span>,<span class="dv">100</span>)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>y1 <span class="op">=</span> np.sin(x_values)         <span class="co"># sinusoidal function</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>y2 <span class="op">=</span> (x_values <span class="op">-</span> <span class="dv">3</span>)<span class="op">**</span><span class="dv">2</span> <span class="op">/</span> <span class="dv">12</span>   <span class="co"># a simple quadratic curve</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>y3 <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span>x_values <span class="op">-</span> <span class="fl">1.0</span>       <span class="co"># a simple linear function</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>plt.plot(x_values, y1, <span class="st">'b-'</span>, x_values, y2, <span class="st">'g--'</span>)<span class="op">;</span>  <span class="co"># plot two curves</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>plt.plot(x_values, y3, <span class="st">'r:'</span>)<span class="op">;</span> <span class="co"># add a curve to the plot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="notes_files/figure-html/cell-64-output-1.png" width="582" height="411"></p>
</div>
</div>
<p>You may want to explicitly set the plot ranges -- perhaps the most common pattern is to plot something, get the plot’s ranges, and then restore them later after plotting another function:</p>
<div class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>x_values <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">8</span>,<span class="dv">100</span>)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>y1 <span class="op">=</span> np.sin(x_values)         <span class="co"># sinusoidal function</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>y3 <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span>x_values <span class="op">-</span> <span class="fl">1.0</span>       <span class="co"># a simple linear function</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>plt.plot(x_values, y1, <span class="st">'b-'</span>) </span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.axis()               <span class="co"># get the x and y axis ranges</span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ax)</span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="co"># now plot something else (which will change the axis ranges):</span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>plt.plot(x_values, y3, <span class="st">'r:'</span>)<span class="op">;</span> <span class="co"># add the linear curve</span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>plt.axis(ax)<span class="op">;</span>                 <span class="co"># restore the original plot's axis ranges</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(-0.4, 8.4, -1.099652011574681, 1.0998559934443881)</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="notes_files/figure-html/cell-65-output-2.png" width="590" height="411"></p>
</div>
</div>
</section>
<section id="legends" class="level2">
<h2 class="anchored" data-anchor-id="legends">Legends</h2>
<p>When plotting multiple point sets or curves we’ll likely want to be able to distinguish what each plot represents. We can do this by specifying a <em>label</em> for each plot, then adding a <em>legend</em> that tells us what each represents.</p>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>x_values <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">8</span>,<span class="dv">100</span>)</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>y1 <span class="op">=</span> np.sin(x_values)         <span class="co"># sinusoidal function</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>y2 <span class="op">=</span> (x_values <span class="op">-</span> <span class="dv">3</span>)<span class="op">**</span><span class="dv">2</span> <span class="op">/</span> <span class="dv">12</span>   <span class="co"># a simple quadratic curve</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>y3 <span class="op">=</span> <span class="fl">0.5</span><span class="op">*</span>x_values <span class="op">-</span> <span class="fl">1.0</span>       <span class="co"># a simple linear function</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>plt.plot(x_values, y1, <span class="st">'b-'</span>, label<span class="op">=</span><span class="st">'sin(x)'</span>)<span class="op">;</span>  <span class="co"># plot two curves</span></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>plt.plot(x_values, y2, <span class="st">'g--'</span>, label<span class="op">=</span><span class="st">'$(x-3)^2 / 12$'</span>)</span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>plt.plot(x_values, y3, <span class="st">'r:'</span>, label<span class="op">=</span><span class="st">'$.5x-1$'</span>)<span class="op">;</span> <span class="co"># add a curve to the plot</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="328">
<pre><code>&lt;matplotlib.legend.Legend at 0x177762520&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="notes_files/figure-html/cell-66-output-2.png" width="582" height="411"></p>
</div>
</div>
<p>Here surrounding text in a label with <code>$ $</code> allows us to write mathamatical equations as in LaTex!</p>
</section>
<section id="histograms" class="level2">
<h2 class="anchored" data-anchor-id="histograms">Histograms</h2>
<p>Histograms are also useful visualizations:</p>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>plt.hist(y2, bins<span class="op">=</span><span class="dv">20</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="notes_files/figure-html/cell-67-output-1.png" width="566" height="411"></p>
</div>
</div>
<p>The outputs of hist include the bin locations, the number of data in each bin, and the “handles” to the plot elements to manipulate their appearance, if desired.</p>
</section>
<section id="subplots-and-plot-sizes" class="level2">
<h2 class="anchored" data-anchor-id="subplots-and-plot-sizes">Subplots and plot sizes</h2>
<p>It is often useful to put more than one plot together in a group; you can do this using the subplot function. There are various options; for example, “sharex” and “sharey” allow multiple plots to share a single axis range (or, you can set it manually, of course).</p>
<p>I often find it necessary to also change the geometry of the figure for multiple subplots -- although this is more generally useful as well, if you have a plot that looks better wider and shorter, for example.</p>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">3</span>, figsize<span class="op">=</span>(<span class="fl">8.0</span>, <span class="fl">2.0</span>))      <span class="co"># make a 1 x 3 grid of plots:</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].plot(x_values, y1, <span class="st">'b-'</span>)<span class="op">;</span>   <span class="co"># plot y1 in the first subplot</span></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].plot(x_values, y2, <span class="st">'g--'</span>)<span class="op">;</span>  <span class="co">#   y2 in the 2nd</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].plot(x_values, y3, <span class="st">'r:'</span>)<span class="op">;</span>   <span class="co">#   and y3 in the last</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="notes_files/figure-html/cell-68-output-1.png" width="656" height="189"></p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>